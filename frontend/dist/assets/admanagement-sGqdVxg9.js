import{g as w,f as m,r as d,v as D,j as e,X as $,h as B,p as O,l as U}from"./index-CytmB-Er.js";import{A as F,M as P}from"./adminlayout-DIdHhvbo.js";import{T as y}from"./textsadminpanel-DB4O06i_.js";import{I as R,A as G,T as V}from"./table-cells-CvzEJ-64.js";import{E as z,D as q}from"./btn-crud-CowRCboy.js";import{P as A}from"./sidebar-left-s-soE1BO.js";import{I as E}from"./image-B_LdI_-E.js";import{T as K}from"./type-CM29f9Lw.js";import{L as X}from"./loader-circle-Bj7yhw_M.js";import{S as H}from"./save-CloRN_9C.js";import{S as W}from"./shield-CrI-2Gqb.js";import"./adslot-1WJBBd70.js";import"./users-DikJyHif.js";import"./database-BnUETau0.js";import"./helpers-CPSgdYRA.js";import"./mail-iCRNgKv8.js";import"./eye-DlkzJROP.js";import"./log-out-DPAkzXIl.js";import"./user-BVnW-pgT.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Q=w("check",J);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Z=w("code",Y);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ae=w("pen",ee),g={getAll:async()=>await m.get("/admin/ads"),getActive:async()=>await m.get("/ads/active"),create:async r=>await m.post("/admin/ads",r),update:async(r,i)=>await m.put(`/admin/ads/${r}`,i),delete:async r=>await m.delete(`/admin/ads/${r}`),toggleAdBlock:async r=>m.post("/admin/ads/toggle-adblock",{enabled:r}),uploadImage:async r=>{const i=new FormData;return i.append("image",r),await m.post("/admin/ads/upload",i,{headers:{"Content-Type":"multipart/form-data"}})}};function te(){const[r,i]=d.useState([]),[b,h]=d.useState(!0),{showSuccess:x,showError:o,showConfirm:u}=D(),[l,p]=d.useState(!1),[t,s]=d.useState({name:"",placement:"ad_landing_top",type:"script",content:"",redirect_url:"",is_active:!0}),[f,N]=d.useState(!1),j=async()=>{try{h(!0);const a=await g.getAll();i(a)}catch{o("فشل تحميل الإعلانات")}finally{h(!1)}};d.useEffect(()=>{j()},[]);const v=()=>{s({name:"",placement:"ad_landing_top",type:"script",content:"",redirect_url:"",is_active:!0}),p(!1)},T=async a=>{if(a&&a.preventDefault(),!t.name||!t.content){o("يرجى ملء جميع الحقول المطلوبة");return}N(!0);try{t.id?(await g.update(t.id,t),x("تم تحديث الإعلان بنجاح")):(await g.create(t),x("تم إنشاء الإعلان بنجاح")),v(),j()}catch{o("حدث خطأ أثناء الحفظ")}finally{N(!1)}},I=async a=>{if(await u({title:"حذف الإعلان",message:"هل أنت متأكد من حذف هذا الإعلان؟ لا يمكن التراجع عن هذا الإجراء.",confirmLabel:"نعم، احذف",cancelLabel:"إلغاء",variant:"danger"}))try{await g.delete(a),x("تم حذف الإعلان بنجاح"),j()}catch{o("فشل حذف الإعلان")}},k=[{value:"ad_landing_top",label:"أعلى صفحة الهبوط"},{value:"ad_landing_footer",label:"أسفل صفحة الهبوط"},{value:"ad_sidebar_square",label:"الشريط الجانبي"},{value:"ad_footer_leaderboard",label:"فوتر المشتركين"}],L=d.useMemo(()=>[{header:"الإعلان",accessor:a=>e.jsx(R,{name:a.name,avatar:a.type==="image"?a.content:void 0,subtext:`${a.type.toUpperCase()} UNIT • ID: ${a.id}`}),exportValue:a=>a.name,className:"min-w-[250px]"},{header:"مكان الظهور",accessor:a=>{var n;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary/40"}),e.jsx("span",{className:"text-sm font-black text-gray-600 dark:text-gray-400",children:((n=k.find(c=>c.value===a.placement))==null?void 0:n.label)||a.placement})]})},exportValue:a=>{var n;return((n=k.find(c=>c.value===a.placement))==null?void 0:n.label)||a.placement}},{header:"النوع",accessor:a=>e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-dark-800 rounded-xl text-[10px] font-black text-gray-500 dark:text-gray-400 inline-block uppercase tracking-widest",children:a.type}),exportValue:a=>a.type},{header:"الإحصائيات",accessor:a=>{var n,c;return e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-lg font-black text-blue-500 leading-none",children:((n=a.stats)==null?void 0:n.impressions)||0}),e.jsx("div",{className:"text-[8px] font-black text-gray-400 uppercase tracking-widest",children:"View"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-100 dark:bg-white/5"}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-lg font-black text-emerald-500 leading-none",children:((c=a.stats)==null?void 0:c.clicks)||0}),e.jsx("div",{className:"text-[8px] font-black text-gray-400 uppercase tracking-widest",children:"Click"})]})]})},className:"text-center"},{header:"الحالة",accessor:a=>e.jsx("div",{className:"flex justify-center",children:a.is_active?e.jsxs("div",{className:"flex items-center gap-3 px-5 py-2 bg-green-50 dark:bg-green-500/10 text-green-600 rounded-[1.5rem] text-[11px] font-black border border-green-100 dark:border-green-500/20 shadow-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse shadow-[0_0_10px_rgba(34,197,94,0.5)]"}),"مفعل"]}):e.jsxs("div",{className:"flex items-center gap-3 px-5 py-2 bg-gray-100 dark:bg-dark-800 text-gray-400 rounded-[1.5rem] text-[11px] font-black border border-gray-200 dark:border-white/5 opacity-60",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),"متوقف"]})}),className:"text-center"},{header:"التحكم",accessor:a=>e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(z,{type:"icon",onClick:()=>{s(a),p(!0)}}),e.jsx(q,{type:"icon",onClick:()=>I(a.id)})]})}),className:"text-left"}],[k]),[_,S]=d.useState(!1),M=async a=>{var c;const n=(c=a.target.files)==null?void 0:c[0];if(n){S(!0);try{const C=await g.uploadImage(n);s({...t,content:C.url}),x("تم رفع الصورة بنجاح")}catch{o("فشل رفع الصورة")}finally{S(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(V,{columns:L,data:r,isLoading:b,exportFileName:"جدول_الإعلانات",emptyMessage:"لا توجد إعلانات مخصصة بعد"}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsxs("button",{onClick:()=>{p(!0),s({name:"",placement:"ad_landing_top",type:"script",content:"",redirect_url:"",is_active:!0})},className:"flex items-center gap-3 px-10 py-5 bg-primary text-white rounded-[2rem] font-black shadow-2xl shadow-primary/30 hover:scale-105 transition-all active:scale-95 group",children:[e.jsx(A,{className:"w-7 h-7 group-hover:rotate-90 transition-transform duration-300"}),e.jsx("span",{className:"text-lg",children:"إضافة إعلان جديد"})]})})]}),l&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-dark-900 rounded-[3rem] w-full max-w-xl shadow-2xl overflow-hidden border border-gray-100 dark:border-white/5 flex flex-col animate-in zoom-in-95 duration-500 max-h-[90vh]",onMouseDown:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"px-10 py-8 border-b border-gray-50 dark:border-white/10 flex items-center justify-between bg-gray-50/50 dark:bg-dark-950/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-2xl text-primary",children:t.id?e.jsx(ae,{className:"w-6 h-6"}):e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 dark:text-white",children:t.id?"تعديل الإعلان":"إضافة إعلان جديد"}),e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mt-0.5",children:"تفاصيل الحملة الإعلانية"})]})]}),e.jsx("button",{onClick:v,className:"p-3 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-400 hover:text-red-500 rounded-2xl transition-all",children:e.jsx($,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:T,className:"flex-1 overflow-y-auto p-10 space-y-6 no-scrollbar",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"اسم الحملة"}),e.jsx("input",{type:"text",value:t.name,onChange:a=>s({...t,name:a.target.value}),className:"w-full px-8 py-5 rounded-2xl border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all font-bold text-lg",placeholder:"مثال: عرض الصيف 2024",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"مكان الظهور"}),e.jsx("select",{value:t.placement,onChange:a=>s({...t,placement:a.target.value}),className:"w-full px-6 py-5 rounded-2xl border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all font-bold",children:k.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"الحالة"}),e.jsxs("div",{className:"flex p-1 bg-gray-50 dark:bg-dark-950 rounded-2xl border border-gray-100 dark:border-white/10 h-[62px]",children:[e.jsx("button",{type:"button",onClick:()=>s({...t,is_active:!0}),className:`flex-1 rounded-xl text-xs font-black transition-all ${t.is_active?"bg-white dark:bg-dark-700 shadow-sm text-green-500":"text-gray-400 opacity-50"}`,children:"نشط"}),e.jsx("button",{type:"button",onClick:()=>s({...t,is_active:!1}),className:`flex-1 rounded-xl text-xs font-black transition-all ${t.is_active?"text-gray-400 opacity-50":"bg-white dark:bg-dark-700 shadow-sm text-red-500"}`,children:"متوقف"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"نوع الإعلان"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{id:"script",label:"Script",icon:Z},{id:"image",label:"Image",icon:E},{id:"html",label:"HTML",icon:K}].map(a=>e.jsxs("button",{type:"button",onClick:()=>s({...t,type:a.id}),className:`flex flex-col items-center gap-3 p-5 rounded-[2rem] border-2 transition-all group ${t.type===a.id?"border-primary bg-primary/5 text-primary":"border-gray-50 dark:border-white/10 text-gray-400"}`,children:[e.jsx(a.icon,{className:`w-6 h-6 ${t.type===a.id?"":"grayscale opacity-50"}`}),e.jsx("span",{className:"text-[10px] font-black tracking-widest uppercase",children:a.label})]},a.id))})]}),t.type==="image"?e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"رفع صورة الإعلان"}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"file",onChange:M,accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",disabled:_}),e.jsx("div",{className:"w-full h-40 rounded-[2rem] border-2 border-dashed border-gray-100 dark:border-white/10 bg-gray-50/30 dark:bg-dark-950 flex flex-col items-center justify-center gap-3 group-hover:border-primary/50 transition-all overflow-hidden relative",children:_?e.jsx(X,{className:"w-8 h-8 text-primary animate-spin"}):t.content&&t.content.startsWith("http")?e.jsx("img",{src:t.content,className:"w-full h-full object-contain p-4",alt:"Preview"}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-10 h-10 text-gray-300"}),e.jsx("span",{className:"text-xs font-black text-gray-400",children:"اسحب الصورة هنا أو اضغط للرفع"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"أو رابط الصورة المباشر"}),e.jsx("input",{type:"text",value:t.content,onChange:a=>s({...t,content:a.target.value}),className:"w-full px-8 py-5 rounded-2xl border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all font-bold ltr",placeholder:"https://example.com/banner.jpg"})]})]}):e.jsxs("div",{className:"space-y-2 animate-in fade-in duration-500",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"الكود الإعلاني"}),e.jsx("textarea",{value:t.content,onChange:a=>s({...t,content:a.target.value}),className:"w-full h-40 px-8 py-5 rounded-[2rem] border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all font-mono text-xs ltr no-scrollbar",placeholder:t.type==="script"?'<script src="..."><\/script>':"<div>...</div>",required:!0})]}),t.type==="image"&&e.jsxs("div",{className:"space-y-2 animate-in slide-in-from-top duration-300",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"رابط التوجيه (Redirect URL)"}),e.jsx("input",{type:"text",value:t.redirect_url||"",onChange:a=>s({...t,redirect_url:a.target.value}),className:"w-full px-8 py-5 rounded-2xl border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all font-bold text-lg ltr",placeholder:"https://example.com/buy-now"})]}),e.jsxs("div",{className:"pt-6 flex gap-4",children:[e.jsxs("button",{type:"submit",disabled:f,className:"flex-1 py-5 bg-primary text-white rounded-[2rem] font-black shadow-xl shadow-primary/20 hover:scale-[1.02] active:scale-95 transition-all text-xl flex items-center justify-center gap-4 group disabled:opacity-50",children:[f?e.jsx("div",{className:"w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(Q,{className:"w-7 h-7 group-hover:scale-125 transition-transform"}),e.jsx("span",{children:t.id?"حفظ التغييرات":"نشر الإعلان"})]}),e.jsx("button",{type:"button",onClick:v,className:"px-8 bg-gray-100 dark:bg-dark-800 text-gray-700 dark:text-gray-300 rounded-[2rem] font-bold hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors",children:"إلغاء"})]})]})]})})]})}function ve(){const{settings:r,updateSettings:i}=B(),{showSuccess:b,showError:h}=D(),{setPrimaryAction:x}=O(),[o,u]=d.useState(!1),[l,p]=d.useState({adblock_enabled:r.adblock_enabled==="true"||r.adblock_enabled===!0||r.adblock_enabled==="1"||r.adblock_enabled===1});d.useEffect(()=>{p({adblock_enabled:r.adblock_enabled==="true"||r.adblock_enabled===!0||r.adblock_enabled==="1"||r.adblock_enabled===1})},[r.adblock_enabled]);const t=async s=>{u(!0);try{await g.toggleAdBlock(l.adblock_enabled),await i({}),b(y.MESSAGES.SUCCESS)}catch(f){U.error(f),h(y.MESSAGES.ERROR)}finally{u(!1)}};return d.useEffect(()=>(x({label:o?"جاري الحفظ...":"حفظ الإعدادات",onClick:()=>t(),icon:H,loading:o,variant:"primary"}),()=>x(null)),[o,l]),e.jsx(F,{title:"إدارة الإعلانات",children:e.jsxs("div",{className:"h-full flex flex-col p-6 space-y-12 animate-in fade-in duration-700",children:[e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx(te,{})}),e.jsxs("div",{className:"premium-card p-12 transition-all hover:shadow-2xl group/card border-t border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-12 border-b border-gray-50 dark:border-white/5 pb-8",children:[e.jsx("div",{className:"p-4 rounded-3xl bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 group-hover/card:scale-110 transition-transform duration-500",children:e.jsx(P,{className:"w-10 h-10"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-black text-gray-900 dark:text-white tracking-tight leading-none",children:y.SETTINGS.ADBLOCK_DETECTION}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-base font-medium mt-2",children:y.SETTINGS.ADBLOCK_DESC})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-10 bg-white dark:bg-dark-800/40 rounded-[2.5rem] border border-gray-100 dark:border-white/5 shadow-sm hover:shadow-md transition-all duration-500",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-xl font-bold text-gray-900 dark:text-white",children:y.SETTINGS.ADBLOCK_ENABLED}),e.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-[10px] uppercase tracking-tighter font-black transition-all duration-500 ${l.adblock_enabled?"bg-green-500/10 text-green-600 dark:text-green-400":"bg-gray-100 dark:bg-dark-700 text-gray-500"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${l.adblock_enabled?"bg-green-500 animate-pulse":"bg-gray-400"}`}),l.adblock_enabled?"مفعل وقيد التشغيل":"معطل حالياً"]})]}),e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 max-w-xl leading-relaxed",children:"تفعيل خاصية الكشف الإلزامي تمنع المستخدمين من الوصول للمحتوى إلا بعد تعطيل مانع الإعلانات، مما يضمن استمرارية دعم المنصة وزيادة عوائد الإعلانات."})]}),e.jsx("div",{className:"flex items-center shrink-0",children:e.jsxs("button",{type:"button",disabled:o,onClick:async()=>{const s=!l.adblock_enabled;p({...l,adblock_enabled:s}),u(!0);try{await g.toggleAdBlock(s),await i({}),b("تم التحديث تلقائياً بنجاح")}catch{p({...l,adblock_enabled:!s}),h("فشل التحديث التلقائي")}finally{u(!1)}},className:`flex items-center gap-3 px-8 py-4 rounded-2xl font-black text-sm transition-all duration-500 shadow-xl group hover:scale-[1.02] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed ${l.adblock_enabled?"bg-orange-500 text-white hover:bg-orange-600 shadow-orange-500/30":"bg-white dark:bg-dark-700 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 hover:bg-gray-50 dark:hover:bg-dark-600 shadow-gray-200/20"}`,children:[o?e.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.jsx(W,{className:`w-5 h-5 transition-transform duration-500 group-hover:rotate-12 ${l.adblock_enabled?"text-white":"text-primary"}`}),l.adblock_enabled?e.jsx("span",{children:"إيقاف التشغيل الفوري"}):e.jsx("span",{children:"تفعيل الكاشف (حفظ تلقائي)"})]})})]})]})]})})}export{ve as default};

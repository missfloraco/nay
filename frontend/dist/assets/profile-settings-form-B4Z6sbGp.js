import{R as q,q as jr,r as he,y as Sr,j as g,f as Dr}from"./index-CytmB-Er.js";import{p as Or,a as Ur,$ as Cr,o as Rr,s as se}from"./schemas-CsUKkzBv.js";import{C as Lr}from"./circularimageupload-0BiuJqTW.js";import{r as Ye}from"./helpers-CPSgdYRA.js";import{C as Tr}from"./constants-DPRNOWFl.js";import{U as Ir}from"./user-BVnW-pgT.js";import{S as Pr}from"./shield-CrI-2Gqb.js";import{L as Mr}from"./loader-circle-Bj7yhw_M.js";import{S as Br}from"./save-CloRN_9C.js";var xe=e=>e.type==="checkbox",le=e=>e instanceof Date,M=e=>e==null;const fr=e=>typeof e=="object";var R=e=>!M(e)&&!Array.isArray(e)&&fr(e)&&!le(e),qr=e=>R(e)&&e.target?xe(e.target)?e.target.checked:e.target.value:e,Wr=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,$r=(e,s)=>e.has(Wr(s)),Hr=e=>{const s=e.constructor&&e.constructor.prototype;return R(s)&&s.hasOwnProperty("isPrototypeOf")},Oe=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function T(e){if(e instanceof Date)return new Date(e);const s=typeof FileList<"u"&&e instanceof FileList;if(Oe&&(e instanceof Blob||s))return e;const r=Array.isArray(e);if(!r&&!(R(e)&&Hr(e)))return e;const i=r?[]:Object.create(Object.getPrototypeOf(e));for(const d in e)Object.prototype.hasOwnProperty.call(e,d)&&(i[d]=T(e[d]));return i}var _e=e=>/^\w*$/.test(e),D=e=>e===void 0,Ue=e=>Array.isArray(e)?e.filter(Boolean):[],Ce=e=>Ue(e.replace(/["|']|\]/g,"").split(/\.|\[/)),h=(e,s,r)=>{if(!s||!R(e))return r;const i=(_e(s)?[s]:Ce(s)).reduce((d,n)=>M(d)?d:d[n],e);return D(i)||i===e?D(e[s])?r:e[s]:i},G=e=>typeof e=="boolean",J=e=>typeof e=="function",k=(e,s,r)=>{let i=-1;const d=_e(s)?[s]:Ce(s),n=d.length,l=n-1;for(;++i<n;){const c=d[i];let A=r;if(i!==l){const L=e[c];A=R(L)||Array.isArray(L)?L:isNaN(+d[i+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;e[c]=A,e=e[c]}};const Je={BLUR:"blur",FOCUS_OUT:"focusout"},Q={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},re={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},zr=q.createContext(null);zr.displayName="HookFormContext";var Kr=(e,s,r,i=!0)=>{const d={defaultValues:s._defaultValues};for(const n in e)Object.defineProperty(d,n,{get:()=>{const l=n;return s._proxyFormState[l]!==Q.all&&(s._proxyFormState[l]=!i||Q.all),e[l]}});return d};const Zr=typeof window<"u"?q.useLayoutEffect:q.useEffect;var W=e=>typeof e=="string",Yr=(e,s,r,i,d)=>W(e)?(i&&s.watch.add(e),h(r,e,d)):Array.isArray(e)?e.map(n=>(i&&s.watch.add(n),h(r,n))):(i&&(s.watchAll=!0),r),je=e=>M(e)||!fr(e);function ie(e,s,r=new WeakSet){if(je(e)||je(s))return Object.is(e,s);if(le(e)&&le(s))return e.getTime()===s.getTime();const i=Object.keys(e),d=Object.keys(s);if(i.length!==d.length)return!1;if(r.has(e)||r.has(s))return!0;r.add(e),r.add(s);for(const n of i){const l=e[n];if(!d.includes(n))return!1;if(n!=="ref"){const c=s[n];if(le(l)&&le(c)||R(l)&&R(c)||Array.isArray(l)&&Array.isArray(c)?!ie(l,c,r):!Object.is(l,c))return!1}}return!0}var Re=(e,s,r,i,d)=>s?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[i]:d||!0}}:{},ge=e=>Array.isArray(e)?e:[e],Qe=()=>{let e=[];return{get observers(){return e},next:d=>{for(const n of e)n.next&&n.next(d)},subscribe:d=>(e.push(d),{unsubscribe:()=>{e=e.filter(n=>n!==d)}}),unsubscribe:()=>{e=[]}}};function yr(e,s){const r={};for(const i in e)if(e.hasOwnProperty(i)){const d=e[i],n=s[i];if(d&&R(d)&&n){const l=yr(d,n);R(l)&&(r[i]=l)}else e[i]&&(r[i]=n)}return r}var P=e=>R(e)&&!Object.keys(e).length,Le=e=>e.type==="file",be=e=>{if(!Oe)return!1;const s=e?e.ownerDocument:0;return e instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},hr=e=>e.type==="select-multiple",Te=e=>e.type==="radio",Jr=e=>Te(e)||xe(e),Ne=e=>be(e)&&e.isConnected;function Qr(e,s){const r=s.slice(0,-1).length;let i=0;for(;i<r;)e=D(e)?i++:e[s[i++]];return e}function Xr(e){for(const s in e)if(e.hasOwnProperty(s)&&!D(e[s]))return!1;return!0}function C(e,s){const r=Array.isArray(s)?s:_e(s)?[s]:Ce(s),i=r.length===1?e:Qr(e,r),d=r.length-1,n=r[d];return i&&delete i[n],d!==0&&(R(i)&&P(i)||Array.isArray(i)&&Xr(i))&&C(e,r.slice(0,-1)),e}var Gr=e=>{for(const s in e)if(J(e[s]))return!0;return!1};function mr(e){return Array.isArray(e)||R(e)&&!Gr(e)}function Se(e,s={}){for(const r in e){const i=e[r];mr(i)?(s[r]=Array.isArray(i)?[]:{},Se(i,s[r])):D(i)||(s[r]=!0)}return s}function ue(e,s,r){r||(r=Se(s));for(const i in e){const d=e[i];if(mr(d))D(s)||je(r[i])?r[i]=Se(d,Array.isArray(d)?[]:{}):ue(d,M(s)?{}:s[i],r[i]);else{const n=s[i];r[i]=!ie(d,n)}}return r}const Xe={value:!1,isValid:!1},Ge={value:!0,isValid:!0};var gr=e=>{if(Array.isArray(e)){if(e.length>1){const s=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:s,isValid:!!s.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!D(e[0].attributes.value)?D(e[0].value)||e[0].value===""?Ge:{value:e[0].value,isValid:!0}:Ge:Xe}return Xe},vr=(e,{valueAsNumber:s,valueAsDate:r,setValueAs:i})=>D(e)?e:s?e===""?NaN:e&&+e:r&&W(e)?new Date(e):i?i(e):e;const er={isValid:!1,value:null};var xr=e=>Array.isArray(e)?e.reduce((s,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:s,er):er;function rr(e){const s=e.ref;return Le(s)?s.files:Te(s)?xr(e.refs).value:hr(s)?[...s.selectedOptions].map(({value:r})=>r):xe(s)?gr(e.refs).value:vr(D(s.value)?e.ref.value:s.value,e)}var et=(e,s,r,i)=>{const d={};for(const n of e){const l=h(s,n);l&&k(d,n,l._f)}return{criteriaMode:r,names:[...e],fields:d,shouldUseNativeValidation:i}},we=e=>e instanceof RegExp,me=e=>D(e)?e:we(e)?e.source:R(e)?we(e.value)?e.value.source:e.value:e,tr=e=>({isOnSubmit:!e||e===Q.onSubmit,isOnBlur:e===Q.onBlur,isOnChange:e===Q.onChange,isOnAll:e===Q.all,isOnTouch:e===Q.onTouched});const sr="AsyncFunction";var rt=e=>!!e&&!!e.validate&&!!(J(e.validate)&&e.validate.constructor.name===sr||R(e.validate)&&Object.values(e.validate).find(s=>s.constructor.name===sr)),tt=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),ir=(e,s,r)=>!r&&(s.watchAll||s.watch.has(e)||[...s.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const ve=(e,s,r,i)=>{for(const d of r||Object.keys(e)){const n=h(e,d);if(n){const{_f:l,...c}=n;if(l){if(l.refs&&l.refs[0]&&s(l.refs[0],d)&&!i)return!0;if(l.ref&&s(l.ref,l.name)&&!i)return!0;if(ve(c,s))break}else if(R(c)&&ve(c,s))break}}};function ar(e,s,r){const i=h(e,r);if(i||_e(r))return{error:i,name:r};const d=r.split(".");for(;d.length;){const n=d.join("."),l=h(s,n),c=h(e,n);if(l&&!Array.isArray(l)&&r!==n)return{name:r};if(c&&c.type)return{name:n,error:c};if(c&&c.root&&c.root.type)return{name:`${n}.root`,error:c.root};d.pop()}return{name:r}}var st=(e,s,r,i)=>{r(e);const{name:d,...n}=e;return P(n)||Object.keys(n).length>=Object.keys(s).length||Object.keys(n).find(l=>s[l]===(!i||Q.all))},it=(e,s,r)=>!e||!s||e===s||ge(e).some(i=>i&&(r?i===s:i.startsWith(s)||s.startsWith(i))),at=(e,s,r,i,d)=>d.isOnAll?!1:!r&&d.isOnTouch?!(s||e):(r?i.isOnBlur:d.isOnBlur)?!e:(r?i.isOnChange:d.isOnChange)?e:!0,nt=(e,s)=>!Ue(h(e,s)).length&&C(e,s),ot=(e,s,r)=>{const i=ge(h(e,r));return k(i,"root",s[r]),k(e,r,i),e};function nr(e,s,r="validate"){if(W(e)||Array.isArray(e)&&e.every(W)||G(e)&&!e)return{type:r,message:W(e)?e:"",ref:s}}var de=e=>R(e)&&!we(e)?e:{value:e,message:""},or=async(e,s,r,i,d,n)=>{const{ref:l,refs:c,required:A,maxLength:L,minLength:H,min:w,max:N,pattern:p,validate:z,name:O,valueAsNumber:K,mount:j}=e._f,b=h(r,O);if(!j||s.has(O))return{};const I=c?c[0]:l,Z=x=>{d&&I.reportValidity&&(I.setCustomValidity(G(x)?"":x||""),I.reportValidity())},S={},ae=Te(l),ne=xe(l),X=ae||ne,ee=(K||Le(l))&&D(l.value)&&D(b)||be(l)&&l.value===""||b===""||Array.isArray(b)&&!b.length,_=Re.bind(null,O,i,S),oe=(x,v,E,U=re.maxLength,Y=re.minLength)=>{const B=x?v:E;S[O]={type:x?U:Y,message:B,ref:l,..._(x?U:Y,B)}};if(n?!Array.isArray(b)||!b.length:A&&(!X&&(ee||M(b))||G(b)&&!b||ne&&!gr(c).isValid||ae&&!xr(c).isValid)){const{value:x,message:v}=W(A)?{value:!!A,message:A}:de(A);if(x&&(S[O]={type:re.required,message:v,ref:I,..._(re.required,v)},!i))return Z(v),S}if(!ee&&(!M(w)||!M(N))){let x,v;const E=de(N),U=de(w);if(!M(b)&&!isNaN(b)){const Y=l.valueAsNumber||b&&+b;M(E.value)||(x=Y>E.value),M(U.value)||(v=Y<U.value)}else{const Y=l.valueAsDate||new Date(b),B=ye=>new Date(new Date().toDateString()+" "+ye),ce=l.type=="time",fe=l.type=="week";W(E.value)&&b&&(x=ce?B(b)>B(E.value):fe?b>E.value:Y>new Date(E.value)),W(U.value)&&b&&(v=ce?B(b)<B(U.value):fe?b<U.value:Y<new Date(U.value))}if((x||v)&&(oe(!!x,E.message,U.message,re.max,re.min),!i))return Z(S[O].message),S}if((L||H)&&!ee&&(W(b)||n&&Array.isArray(b))){const x=de(L),v=de(H),E=!M(x.value)&&b.length>+x.value,U=!M(v.value)&&b.length<+v.value;if((E||U)&&(oe(E,x.message,v.message),!i))return Z(S[O].message),S}if(p&&!ee&&W(b)){const{value:x,message:v}=de(p);if(we(x)&&!b.match(x)&&(S[O]={type:re.pattern,message:v,ref:l,..._(re.pattern,v)},!i))return Z(v),S}if(z){if(J(z)){const x=await z(b,r),v=nr(x,I);if(v&&(S[O]={...v,..._(re.validate,v.message)},!i))return Z(v.message),S}else if(R(z)){let x={};for(const v in z){if(!P(x)&&!i)break;const E=nr(await z[v](b,r),I,v);E&&(x={...E,..._(v,E.message)},Z(E.message),i&&(S[O]=x))}if(!P(x)&&(S[O]={ref:I,...x},!i))return S}}return Z(!0),S};const lt={mode:Q.onSubmit,reValidateMode:Q.onChange,shouldFocusError:!0};function dt(e={}){let s={...lt,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:J(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},i={},d=R(s.defaultValues)||R(s.values)?T(s.defaultValues||s.values)||{}:{},n=s.shouldUnregister?{}:T(d),l={action:!1,mount:!1,watch:!1,keepIsValid:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},A,L=0;const H={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={...H};let N={...w};const p={array:Qe(),state:Qe()},z=s.criteriaMode===Q.all,O=t=>a=>{clearTimeout(L),L=setTimeout(t,a)},K=async t=>{if(!l.keepIsValid&&!s.disabled&&(w.isValid||N.isValid||t)){let a;s.resolver?(a=P((await X()).errors),j()):a=await _(i,!0),a!==r.isValid&&p.state.next({isValid:a})}},j=(t,a)=>{!s.disabled&&(w.isValidating||w.validatingFields||N.isValidating||N.validatingFields)&&((t||Array.from(c.mount)).forEach(o=>{o&&(a?k(r.validatingFields,o,a):C(r.validatingFields,o))}),p.state.next({validatingFields:r.validatingFields,isValidating:!P(r.validatingFields)}))},b=(t,a=[],o,y,f=!0,u=!0)=>{if(y&&o&&!s.disabled){if(l.action=!0,u&&Array.isArray(h(i,t))){const m=o(h(i,t),y.argA,y.argB);f&&k(i,t,m)}if(u&&Array.isArray(h(r.errors,t))){const m=o(h(r.errors,t),y.argA,y.argB);f&&k(r.errors,t,m),nt(r.errors,t)}if((w.touchedFields||N.touchedFields)&&u&&Array.isArray(h(r.touchedFields,t))){const m=o(h(r.touchedFields,t),y.argA,y.argB);f&&k(r.touchedFields,t,m)}(w.dirtyFields||N.dirtyFields)&&(r.dirtyFields=ue(d,n)),p.state.next({name:t,isDirty:x(t,a),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else k(n,t,a)},I=(t,a)=>{k(r.errors,t,a),p.state.next({errors:r.errors})},Z=t=>{r.errors=t,p.state.next({errors:r.errors,isValid:!1})},S=(t,a,o,y)=>{const f=h(i,t);if(f){const u=h(n,t,D(o)?h(d,t):o);D(u)||y&&y.defaultChecked||a?k(n,t,a?u:rr(f._f)):U(t,u),l.mount&&!l.action&&K()}},ae=(t,a,o,y,f)=>{let u=!1,m=!1;const V={name:t};if(!s.disabled){if(!o||y){(w.isDirty||N.isDirty)&&(m=r.isDirty,r.isDirty=V.isDirty=x(),u=m!==V.isDirty);const F=ie(h(d,t),a);m=!!h(r.dirtyFields,t),F?C(r.dirtyFields,t):k(r.dirtyFields,t,!0),V.dirtyFields=r.dirtyFields,u=u||(w.dirtyFields||N.dirtyFields)&&m!==!F}if(o){const F=h(r.touchedFields,t);F||(k(r.touchedFields,t,o),V.touchedFields=r.touchedFields,u=u||(w.touchedFields||N.touchedFields)&&F!==o)}u&&f&&p.state.next(V)}return u?V:{}},ne=(t,a,o,y)=>{const f=h(r.errors,t),u=(w.isValid||N.isValid)&&G(a)&&r.isValid!==a;if(s.delayError&&o?(A=O(()=>I(t,o)),A(s.delayError)):(clearTimeout(L),A=null,o?k(r.errors,t,o):C(r.errors,t)),(o?!ie(f,o):f)||!P(y)||u){const m={...y,...u&&G(a)?{isValid:a}:{},errors:r.errors,name:t};r={...r,...m},p.state.next(m)}},X=async t=>(j(t,!0),await s.resolver(n,s.context,et(t||c.mount,i,s.criteriaMode,s.shouldUseNativeValidation))),ee=async t=>{const{errors:a}=await X(t);if(j(t),t)for(const o of t){const y=h(a,o);y?k(r.errors,o,y):C(r.errors,o)}else r.errors=a;return a},_=async(t,a,o={valid:!0})=>{for(const y in t){const f=t[y];if(f){const{_f:u,...m}=f;if(u){const V=c.array.has(u.name),F=f._f&&rt(f._f);F&&w.validatingFields&&j([u.name],!0);const $=await or(f,c.disabled,n,z,s.shouldUseNativeValidation&&!a,V);if(F&&w.validatingFields&&j([u.name]),$[u.name]&&(o.valid=!1,a))break;!a&&(h($,u.name)?V?ot(r.errors,$,u.name):k(r.errors,u.name,$[u.name]):C(r.errors,u.name))}!P(m)&&await _(m,a,o)}}return o.valid},oe=()=>{for(const t of c.unMount){const a=h(i,t);a&&(a._f.refs?a._f.refs.every(o=>!Ne(o)):!Ne(a._f.ref))&&Ve(t)}c.unMount=new Set},x=(t,a)=>!s.disabled&&(t&&a&&k(n,t,a),!ie(Ie(),d)),v=(t,a,o)=>Yr(t,c,{...l.mount?n:D(a)?d:W(t)?{[t]:a}:a},o,a),E=t=>Ue(h(l.mount?n:d,t,s.shouldUnregister?h(d,t,[]):[])),U=(t,a,o={})=>{const y=h(i,t);let f=a;if(y){const u=y._f;u&&(!u.disabled&&k(n,t,vr(a,u)),f=be(u.ref)&&M(a)?"":a,hr(u.ref)?[...u.ref.options].forEach(m=>m.selected=f.includes(m.value)):u.refs?xe(u.ref)?u.refs.forEach(m=>{(!m.defaultChecked||!m.disabled)&&(Array.isArray(f)?m.checked=!!f.find(V=>V===m.value):m.checked=f===m.value||!!f)}):u.refs.forEach(m=>m.checked=m.value===f):Le(u.ref)?u.ref.value="":(u.ref.value=f,u.ref.type||p.state.next({name:t,values:T(n)})))}(o.shouldDirty||o.shouldTouch)&&ae(t,f,o.shouldTouch,o.shouldDirty,!0),o.shouldValidate&&ye(t)},Y=(t,a,o)=>{for(const y in a){if(!a.hasOwnProperty(y))return;const f=a[y],u=t+"."+y,m=h(i,u);(c.array.has(t)||R(f)||m&&!m._f)&&!le(f)?Y(u,f,o):U(u,f,o)}},B=(t,a,o={})=>{const y=h(i,t),f=c.array.has(t),u=T(a);k(n,t,u),f?(p.array.next({name:t,values:T(n)}),(w.isDirty||w.dirtyFields||N.isDirty||N.dirtyFields)&&o.shouldDirty&&p.state.next({name:t,dirtyFields:ue(d,n),isDirty:x(t,u)})):y&&!y._f&&!M(u)?Y(t,u,o):U(t,u,o),ir(t,c)&&p.state.next({...r,name:t}),p.state.next({name:l.mount?t:void 0,values:T(n)})},ce=async t=>{l.mount=!0;const a=t.target;let o=a.name,y=!0;const f=h(i,o),u=F=>{y=Number.isNaN(F)||le(F)&&isNaN(F.getTime())||ie(F,h(n,o,F))},m=tr(s.mode),V=tr(s.reValidateMode);if(f){let F,$;const pe=a.type?rr(f._f):qr(t),te=t.type===Je.BLUR||t.type===Je.FOCUS_OUT,Ar=!tt(f._f)&&!s.resolver&&!h(r.errors,o)&&!f._f.deps||at(te,h(r.touchedFields,o),r.isSubmitted,V,m),Ae=ir(o,c,te);k(n,o,pe),te?(!a||!a.readOnly)&&(f._f.onBlur&&f._f.onBlur(t),A&&A(0)):f._f.onChange&&f._f.onChange(t);const Ee=ae(o,pe,te),Er=!P(Ee)||Ae;if(!te&&p.state.next({name:o,type:t.type,values:T(n)}),Ar)return(w.isValid||N.isValid)&&(s.mode==="onBlur"?te&&K():te||K()),Er&&p.state.next({name:o,...Ae?{}:Ee});if(!te&&Ae&&p.state.next({...r}),s.resolver){const{errors:Ke}=await X([o]);if(j([o]),u(pe),y){const Nr=ar(r.errors,i,o),Ze=ar(Ke,i,Nr.name||o);F=Ze.error,o=Ze.name,$=P(Ke)}}else j([o],!0),F=(await or(f,c.disabled,n,z,s.shouldUseNativeValidation))[o],j([o]),u(pe),y&&(F?$=!1:(w.isValid||N.isValid)&&($=await _(i,!0)));y&&(f._f.deps&&(!Array.isArray(f._f.deps)||f._f.deps.length>0)&&ye(f._f.deps),ne(o,$,F,Ee))}},fe=(t,a)=>{if(h(r.errors,a)&&t.focus)return t.focus(),1},ye=async(t,a={})=>{let o,y;const f=ge(t);if(s.resolver){const u=await ee(D(t)?t:f);o=P(u),y=t?!f.some(m=>h(u,m)):o}else t?(y=(await Promise.all(f.map(async u=>{const m=h(i,u);return await _(m&&m._f?{[u]:m}:m)}))).every(Boolean),!(!y&&!r.isValid)&&K()):y=o=await _(i);return p.state.next({...!W(t)||(w.isValid||N.isValid)&&o!==r.isValid?{}:{name:t},...s.resolver||!t?{isValid:o}:{},errors:r.errors}),a.shouldFocus&&!y&&ve(i,fe,t?f:c.mount),y},Ie=(t,a)=>{let o={...l.mount?n:d};return a&&(o=yr(a.dirtyFields?r.dirtyFields:r.touchedFields,o)),D(t)?o:W(t)?h(o,t):t.map(y=>h(o,y))},Pe=(t,a)=>({invalid:!!h((a||r).errors,t),isDirty:!!h((a||r).dirtyFields,t),error:h((a||r).errors,t),isValidating:!!h(r.validatingFields,t),isTouched:!!h((a||r).touchedFields,t)}),pr=t=>{t&&ge(t).forEach(a=>C(r.errors,a)),p.state.next({errors:t?r.errors:{}})},Me=(t,a,o)=>{const y=(h(i,t,{_f:{}})._f||{}).ref,f=h(r.errors,t)||{},{ref:u,message:m,type:V,...F}=f;k(r.errors,t,{...F,...a,ref:y}),p.state.next({name:t,errors:r.errors,isValid:!1}),o&&o.shouldFocus&&y&&y.focus&&y.focus()},br=(t,a)=>J(t)?p.state.subscribe({next:o=>"values"in o&&t(v(void 0,a),o)}):v(t,a,!0),Be=t=>p.state.subscribe({next:a=>{it(t.name,a.name,t.exact)&&st(a,t.formState||w,Fr,t.reRenderRoot)&&t.callback({values:{...n},...r,...a,defaultValues:d})}}).unsubscribe,wr=t=>(l.mount=!0,N={...N,...t.formState},Be({...t,formState:{...H,...t.formState}})),Ve=(t,a={})=>{for(const o of t?ge(t):c.mount)c.mount.delete(o),c.array.delete(o),a.keepValue||(C(i,o),C(n,o)),!a.keepError&&C(r.errors,o),!a.keepDirty&&C(r.dirtyFields,o),!a.keepTouched&&C(r.touchedFields,o),!a.keepIsValidating&&C(r.validatingFields,o),!s.shouldUnregister&&!a.keepDefaultValue&&C(d,o);p.state.next({values:T(n)}),p.state.next({...r,...a.keepDirty?{isDirty:x()}:{}}),!a.keepIsValid&&K()},qe=({disabled:t,name:a})=>{(G(t)&&l.mount||t||c.disabled.has(a))&&(t?c.disabled.add(a):c.disabled.delete(a))},ke=(t,a={})=>{let o=h(i,t);const y=G(a.disabled)||G(s.disabled);return k(i,t,{...o||{},_f:{...o&&o._f?o._f:{ref:{name:t}},name:t,mount:!0,...a}}),c.mount.add(t),o?qe({disabled:G(a.disabled)?a.disabled:s.disabled,name:t}):S(t,!0,a.value),{...y?{disabled:a.disabled||s.disabled}:{},...s.progressive?{required:!!a.required,min:me(a.min),max:me(a.max),minLength:me(a.minLength),maxLength:me(a.maxLength),pattern:me(a.pattern)}:{},name:t,onChange:ce,onBlur:ce,ref:f=>{if(f){ke(t,a),o=h(i,t);const u=D(f.value)&&f.querySelectorAll&&f.querySelectorAll("input,select,textarea")[0]||f,m=Jr(u),V=o._f.refs||[];if(m?V.find(F=>F===u):u===o._f.ref)return;k(i,t,{_f:{...o._f,...m?{refs:[...V.filter(Ne),u,...Array.isArray(h(d,t))?[{}]:[]],ref:{type:u.type,name:t}}:{ref:u}}}),S(t,!1,void 0,u)}else o=h(i,t,{}),o._f&&(o._f.mount=!1),(s.shouldUnregister||a.shouldUnregister)&&!($r(c.array,t)&&l.action)&&c.unMount.add(t)}}},Fe=()=>s.shouldFocusError&&ve(i,fe,c.mount),_r=t=>{G(t)&&(p.state.next({disabled:t}),ve(i,(a,o)=>{const y=h(i,o);y&&(a.disabled=y._f.disabled||t,Array.isArray(y._f.refs)&&y._f.refs.forEach(f=>{f.disabled=y._f.disabled||t}))},0,!1))},We=(t,a)=>async o=>{let y;o&&(o.preventDefault&&o.preventDefault(),o.persist&&o.persist());let f=T(n);if(p.state.next({isSubmitting:!0}),s.resolver){const{errors:u,values:m}=await X();j(),r.errors=u,f=T(m)}else await _(i);if(c.disabled.size)for(const u of c.disabled)C(f,u);if(C(r.errors,"root"),P(r.errors)){p.state.next({errors:{}});try{await t(f,o)}catch(u){y=u}}else a&&await a({...r.errors},o),Fe(),setTimeout(Fe);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:P(r.errors)&&!y,submitCount:r.submitCount+1,errors:r.errors}),y)throw y},Vr=(t,a={})=>{h(i,t)&&(D(a.defaultValue)?B(t,T(h(d,t))):(B(t,a.defaultValue),k(d,t,T(a.defaultValue))),a.keepTouched||C(r.touchedFields,t),a.keepDirty||(C(r.dirtyFields,t),r.isDirty=a.defaultValue?x(t,T(h(d,t))):x()),a.keepError||(C(r.errors,t),w.isValid&&K()),p.state.next({...r}))},$e=(t,a={})=>{const o=t?T(t):d,y=T(o),f=P(t),u=f?d:y;if(a.keepDefaultValues||(d=o),!a.keepValues){if(a.keepDirtyValues){const m=new Set([...c.mount,...Object.keys(ue(d,n))]);for(const V of Array.from(m))h(r.dirtyFields,V)?k(u,V,h(n,V)):B(V,h(u,V))}else{if(Oe&&D(t))for(const m of c.mount){const V=h(i,m);if(V&&V._f){const F=Array.isArray(V._f.refs)?V._f.refs[0]:V._f.ref;if(be(F)){const $=F.closest("form");if($){$.reset();break}}}}if(a.keepFieldsRef)for(const m of c.mount)B(m,h(u,m));else i={}}n=s.shouldUnregister?a.keepDefaultValues?T(d):{}:T(u),p.array.next({values:{...u}}),p.state.next({values:{...u}})}c={mount:a.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!w.isValid||!!a.keepIsValid||!!a.keepDirtyValues||!s.shouldUnregister&&!P(u),l.watch=!!s.shouldUnregister,l.keepIsValid=!!a.keepIsValid,l.action=!1,a.keepErrors||(r.errors={}),p.state.next({submitCount:a.keepSubmitCount?r.submitCount:0,isDirty:f?!1:a.keepDirty?r.isDirty:!!(a.keepDefaultValues&&!ie(t,d)),isSubmitted:a.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:f?{}:a.keepDirtyValues?a.keepDefaultValues&&n?ue(d,n):r.dirtyFields:a.keepDefaultValues&&t?ue(d,t):a.keepDirty?r.dirtyFields:{},touchedFields:a.keepTouched?r.touchedFields:{},errors:a.keepErrors?r.errors:{},isSubmitSuccessful:a.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:d})},He=(t,a)=>$e(J(t)?t(n):t,{...s.resetOptions,...a}),kr=(t,a={})=>{const o=h(i,t),y=o&&o._f;if(y){const f=y.refs?y.refs[0]:y.ref;f.focus&&setTimeout(()=>{f.focus(),a.shouldSelect&&J(f.select)&&f.select()})}},Fr=t=>{r={...r,...t}},ze={control:{register:ke,unregister:Ve,getFieldState:Pe,handleSubmit:We,setError:Me,_subscribe:Be,_runSchema:X,_updateIsValidating:j,_focusError:Fe,_getWatch:v,_getDirty:x,_setValid:K,_setFieldArray:b,_setDisabledField:qe,_setErrors:Z,_getFieldArray:E,_reset:$e,_resetDefaultValues:()=>J(s.defaultValues)&&s.defaultValues().then(t=>{He(t,s.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:oe,_disableForm:_r,_subjects:p,_proxyFormState:w,get _fields(){return i},get _formValues(){return n},get _state(){return l},set _state(t){l=t},get _defaultValues(){return d},get _names(){return c},set _names(t){c=t},get _formState(){return r},get _options(){return s},set _options(t){s={...s,...t}}},subscribe:wr,trigger:ye,register:ke,handleSubmit:We,watch:br,setValue:B,getValues:Ie,reset:He,resetField:Vr,clearErrors:pr,unregister:Ve,setError:Me,setFocus:kr,getFieldState:Pe};return{...ze,formControl:ze}}function ut(e={}){const s=q.useRef(void 0),r=q.useRef(void 0),[i,d]=q.useState({isDirty:!1,isValidating:!1,isLoading:J(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:J(e.defaultValues)?void 0:e.defaultValues});if(!s.current)if(e.formControl)s.current={...e.formControl,formState:i},e.defaultValues&&!J(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:l,...c}=dt(e);s.current={...c,formState:i}}const n=s.current.control;return n._options=e,Zr(()=>{const l=n._subscribe({formState:n._proxyFormState,callback:()=>d({...n._formState}),reRenderRoot:!0});return d(c=>({...c,isReady:!0})),n._formState.isReady=!0,l},[n]),q.useEffect(()=>n._disableForm(e.disabled),[n,e.disabled]),q.useEffect(()=>{e.mode&&(n._options.mode=e.mode),e.reValidateMode&&(n._options.reValidateMode=e.reValidateMode)},[n,e.mode,e.reValidateMode]),q.useEffect(()=>{e.errors&&(n._setErrors(e.errors),n._focusError())},[n,e.errors]),q.useEffect(()=>{e.shouldUnregister&&n._subjects.state.next({values:n._getWatch()})},[n,e.shouldUnregister]),q.useEffect(()=>{if(n._proxyFormState.isDirty){const l=n._getDirty();l!==i.isDirty&&n._subjects.state.next({isDirty:l})}},[n,i.isDirty]),q.useEffect(()=>{var l;e.values&&!ie(e.values,r.current)?(n._reset(e.values,{keepFieldsRef:!0,...n._options.resetOptions}),!((l=n._options.resetOptions)===null||l===void 0)&&l.keepIsValid||n._setValid(),r.current=e.values,d(c=>({...c}))):n._resetDefaultValues()},[n,e.values]),q.useEffect(()=>{n._state.mount||(n._setValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),s.current.formState=Kr(i,n),s.current}const lr=(e,s,r)=>{if(e&&"reportValidity"in e){const i=h(r,s);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},De=(e,s)=>{for(const r in s.fields){const i=s.fields[r];i&&i.ref&&"reportValidity"in i.ref?lr(i.ref,r,e):i&&i.refs&&i.refs.forEach(d=>lr(d,r,e))}},dr=(e,s)=>{s.shouldUseNativeValidation&&De(e,s);const r={};for(const i in e){const d=h(s.fields,i),n=Object.assign(e[i]||{},{ref:d&&d.ref});if(ct(s.names||Object.keys(e),i)){const l=Object.assign({},h(r,i));k(l,"root",n),k(r,i,l)}else k(r,i,n)}return r},ct=(e,s)=>{const r=ur(s);return e.some(i=>ur(i).match(`^${r}\\.\\d+`))};function ur(e){return e.replace(/\]|\[/g,"")}function cr(e,s){try{var r=e()}catch(i){return s(i)}return r&&r.then?r.then(void 0,s):r}function ft(e,s){for(var r={};e.length;){var i=e[0],d=i.code,n=i.message,l=i.path.join(".");if(!r[l])if("unionErrors"in i){var c=i.unionErrors[0].errors[0];r[l]={message:c.message,type:c.code}}else r[l]={message:n,type:d};if("unionErrors"in i&&i.unionErrors.forEach(function(H){return H.errors.forEach(function(w){return e.push(w)})}),s){var A=r[l].types,L=A&&A[i.code];r[l]=Re(l,s,r,d,L?[].concat(L,i.message):i.message)}e.shift()}return r}function yt(e,s){for(var r={};e.length;){var i=e[0],d=i.code,n=i.message,l=i.path.join(".");if(!r[l])if(i.code==="invalid_union"&&i.errors.length>0){var c=i.errors[0][0];r[l]={message:c.message,type:c.code}}else r[l]={message:n,type:d};if(i.code==="invalid_union"&&i.errors.forEach(function(H){return H.forEach(function(w){return e.push(w)})}),s){var A=r[l].types,L=A&&A[i.code];r[l]=Re(l,s,r,d,L?[].concat(L,i.message):i.message)}e.shift()}return r}function ht(e,s,r){if(r===void 0&&(r={}),(function(i){return"_def"in i&&typeof i._def=="object"&&"typeName"in i._def})(e))return function(i,d,n){try{return Promise.resolve(cr(function(){return Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](i,s)).then(function(l){return n.shouldUseNativeValidation&&De({},n),{errors:{},values:r.raw?Object.assign({},i):l}})},function(l){if((function(c){return Array.isArray(c==null?void 0:c.issues)})(l))return{values:{},errors:dr(ft(l.errors,!n.shouldUseNativeValidation&&n.criteriaMode==="all"),n)};throw l}))}catch(l){return Promise.reject(l)}};if((function(i){return"_zod"in i&&typeof i._zod=="object"})(e))return function(i,d,n){try{return Promise.resolve(cr(function(){return Promise.resolve((r.mode==="sync"?Or:Ur)(e,i,s)).then(function(l){return n.shouldUseNativeValidation&&De({},n),{errors:{},values:r.raw?Object.assign({},i):l}})},function(l){if((function(c){return c instanceof Cr})(l))return{values:{},errors:dr(yt(l.issues,!n.shouldUseNativeValidation&&n.criteriaMode==="all"),n)};throw l}))}catch(l){return Promise.reject(l)}};throw new Error("Invalid input: not a Zod schema")}const mt=Rr({email:se().email("البريد الإلكتروني غير صالح"),password:se().optional(),confirm_password:se().optional()}),gt=e=>!(e.password&&e.password!==e.confirm_password),vt={message:"كلمات المرور غير متطابقة",path:["confirm_password"]},Nt=({initialData:e,apiEndpoint:s,isTenant:r=!1,extraFields:i,onSuccess:d})=>{var ne,X,ee;const{showToast:n}=jr(),[l,c]=he.useState(!1),[A,L]=he.useState(null),[H,w]=he.useState(Ye(e.avatarUrl)||null),[N,p]=he.useState(!1),z=mt.extend({name:se().min(2,"الاسم مطلوب"),whatsapp:r?se().optional():se().optional(),country_code:r?se().optional():se().optional()}).refine(gt,vt),{register:O,handleSubmit:K,formState:{errors:j},reset:b,setValue:I}=ut({resolver:ht(z),defaultValues:{name:e.name||"",email:e.email||"",whatsapp:e.whatsapp||"",country_code:e.country_code||""}});Sr(),he.useEffect(()=>{I("email",e.email||""),I("name",e.name||""),r&&(I("whatsapp",e.whatsapp||""),I("country_code",e.country_code||"")),w(Ye(e.avatarUrl))},[e,r,I]);const Z=_=>{L(_),w(URL.createObjectURL(_)),p(!1)},S=()=>{L(null),w(null),p(!0)},ae=async _=>{var oe,x;c(!0);try{const v=new FormData;v.append("email",_.email),v.append("name",_.name),r&&(v.append("whatsapp",_.whatsapp||""),v.append("country_code",_.country_code||"")),_.password&&(r?v.append("new_password",_.password):v.append("password",_.password)),N?v.append("remove_avatar","1"):A&&v.append("avatar",A);const E=await Dr.post(s,v,{headers:{"Content-Type":"multipart/form-data"}});E.bonus_message?n(E.bonus_message,"success"):n("تم تحديث الملف الشخصي بنجاح","success");const U={..._};A?U.avatarUrl=URL.createObjectURL(A):N&&(U.avatarUrl=null),d==null||d(U),b({..._,password:"",confirm_password:""})}catch(v){const E=((x=(oe=v.response)==null?void 0:oe.data)==null?void 0:x.message)||"حدث خطأ أثناء الحفظ";n(E,"error")}finally{c(!1)}};return g.jsxs("form",{onSubmit:K(ae),className:"space-y-12 max-w-6xl mx-auto w-full",children:[g.jsxs("div",{className:"space-y-10 group",children:[g.jsxs("div",{className:"flex items-center gap-6 border-b border-gray-100 dark:border-dark-800 pb-8 transition-colors group-hover:border-primary/20",children:[g.jsx("div",{className:"p-4 bg-primary/5 dark:bg-primary/10 rounded-[2rem] text-primary shadow-inner",children:g.jsx(Ir,{className:"w-8 h-8"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-black text-3xl text-gray-900 dark:text-white tracking-tight",children:"المعلومات الشخصية"}),g.jsx("p",{className:"text-base font-bold text-gray-400 group-hover:text-gray-500 dark:text-gray-500 transition-colors",children:"تحديث بياناتك الشخصية وصورة الحساب"})]})]}),g.jsxs("div",{className:"grid lg:grid-cols-[280px_1fr] gap-12 items-start",children:[g.jsxs("div",{className:"flex flex-col items-center justify-center p-8 rounded-[2.5rem] bg-gray-50/50 dark:bg-dark-900/40 border border-gray-100 dark:border-dark-800 backdrop-blur-sm",children:[g.jsx(Lr,{image:H,onImageChange:Z,onRemove:S,uploadId:"profile-avatar-upload",label:"صورة الحساب",size:"xl",variant:"circle"}),g.jsx("span",{className:"mt-4 text-[10px] font-black uppercase tracking-[0.2em] text-gray-400",children:"انقر لتغيير الصورة"})]}),g.jsxs("div",{className:"space-y-8 py-2",children:[g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mr-1",children:r?"اسم المتجر":"الاسم الكامل"}),g.jsx("input",{type:"text",...O("name"),className:`input-field ${j.name?"border-red-500":""}`}),j.name&&g.jsx("span",{className:"text-xs text-red-500 font-bold",children:(ne=j.name)==null?void 0:ne.message})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mr-1",children:"البريد الإلكتروني"}),g.jsx("input",{type:"email",...O("email"),className:`input-field ${j.email?"border-red-500":""}`}),j.email&&g.jsx("span",{className:"text-xs text-red-500 font-bold",children:(X=j.email)==null?void 0:X.message})]})]}),r&&g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 border-t border-gray-50 dark:border-dark-800/50",children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mr-1",children:"رقم الواتساب"}),g.jsx("input",{type:"tel",...O("whatsapp"),className:"input-field dir-ltr",placeholder:"059xxxxxxx"})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mr-1",children:"الدولة"}),g.jsxs("select",{...O("country_code"),className:"select-field",children:[g.jsx("option",{value:"",children:"اختر الدولة"}),Tr.map(_=>g.jsx("option",{value:_.code,children:_.name},_.code))]})]})]}),i&&g.jsx("div",{className:"pt-2 animate-in fade-in slide-in-from-bottom-2 duration-700",children:i})]})]})]}),g.jsxs("div",{className:"space-y-10 group pt-4",children:[g.jsxs("div",{className:"flex items-center gap-6 border-b border-gray-100 dark:border-dark-800 pb-8 transition-colors group-hover:border-red-500/20",children:[g.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-500/10 rounded-[2rem] text-red-600 shadow-inner",children:g.jsx(Pr,{className:"w-8 h-8"})}),g.jsxs("div",{children:[g.jsx("h3",{className:"font-black text-3xl text-gray-900 dark:text-white tracking-tight",children:"الأمان وكلمة المرور"}),g.jsx("p",{className:"text-base font-bold text-gray-400 group-hover:text-gray-500 dark:text-gray-500 transition-colors",children:"تحديث بيانات الدخول وحماية الحساب"})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl",children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mr-1",children:"كلمة المرور الجديدة"}),g.jsx("input",{type:"password",...O("password"),className:"input-field",placeholder:"••••••••"})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mr-1",children:"تأكيد كلمة المرور"}),g.jsx("input",{type:"password",...O("confirm_password"),className:`input-field ${j.confirm_password?"border-red-500":""}`,placeholder:"••••••••"}),j.confirm_password&&g.jsx("span",{className:"text-xs text-red-500 font-bold",children:(ee=j.confirm_password)==null?void 0:ee.message})]})]})]}),g.jsx("div",{className:"pt-12 border-t border-gray-100 dark:border-dark-800 flex justify-end",children:g.jsxs("button",{type:"submit",disabled:l,className:"w-full md:w-auto px-12 h-16 flex items-center justify-center gap-3 bg-primary hover:bg-primary-hover text-white rounded-[1.5rem] font-black shadow-2xl shadow-primary/30 transition-all active:scale-95 disabled:opacity-50 min-w-[240px] text-lg",children:[l?g.jsx(Mr,{className:"w-6 h-6 animate-spin"}):g.jsx(Br,{className:"w-6 h-6"}),g.jsx("span",{children:"حفظ التعديلات"})]})})]})};export{Nt as P};

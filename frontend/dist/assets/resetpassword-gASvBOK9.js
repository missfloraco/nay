import{e as q,b as z,r as t,j as e,C as g,i as F,f as A}from"./index-CytmB-Er.js";import{A as b,E as j,P as D}from"./passwordstrengthindicator-2h-1PVB9.js";import{C as y}from"./circle-check-BvJnU8bW.js";import{E as N}from"./eye-DlkzJROP.js";import{L as R}from"./loader-circle-Bj7yhw_M.js";function G(){const[m]=q(),x=z(),[p,h]=t.useState(!1),[d,n]=t.useState(""),[v,k]=t.useState(!1),[i,P]=t.useState(!1),[o,S]=t.useState(!1),[s,u]=t.useState({password:"",confirmPassword:""}),[C,l]=t.useState("weak"),c=m.get("token"),r=m.get("email");t.useEffect(()=>{(!c||!r)&&n("رابط إعادة تعيين كلمة المرور غير صالح")},[c,r]),t.useEffect(()=>{const a=s.password;a.length===0||a.length<6?l("weak"):a.length<10?l("medium"):l("strong")},[s.password]);const E=async a=>{var f,w;if(a.preventDefault(),n(""),s.password.length<8){n("كلمة المرور يجب أن تكون 8 أحرف على الأقل");return}if(s.password!==s.confirmPassword){n("كلمات المرور غير متطابقة");return}h(!0);try{await F(),await A.post("/app/reset-password",{token:c,email:r,password:s.password,password_confirmation:s.confirmPassword}),k(!0),setTimeout(()=>{x("/login")},2e3)}catch(L){n(((w=(f=L.response)==null?void 0:f.data)==null?void 0:w.message)||"حدث خطأ ما. يرجى المحاولة لاحقاً.")}finally{h(!1)}};return v?e.jsx(b,{title:"تم بنجاح!",subtitle:"تم إعادة تعيين كلمة المرور بنجاح",children:e.jsxs("div",{className:"text-center py-8 animate-in zoom-in-95 duration-700",children:[e.jsx("div",{className:"w-24 h-24 bg-accent1/10 rounded-full flex items-center justify-center mx-auto mb-8 shadow-xl shadow-accent1/10",children:e.jsx(y,{className:"w-12 h-12 text-accent1 animate-pulse"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg leading-relaxed mb-6",children:"سيتم تحويلك إلى صفحة تسجيل الدخول..."})]})}):e.jsx(b,{title:"إعادة تعيين كلمة المرور",subtitle:"أدخل كلمة المرور الجديدة لحسابك",children:e.jsxs("form",{onSubmit:E,className:"space-y-6 animate-in fade-in slide-in-from-right-5 duration-500",children:[d&&e.jsxs("div",{role:"alert","aria-live":"assertive",className:"p-4 bg-accent2/10 border-2 border-accent2/20 text-accent2 text-sm font-bold rounded-2xl flex items-center gap-3 animate-in slide-in-from-top-2 duration-300",children:[e.jsx(g,{className:"w-5 h-5 shrink-0"}),e.jsx("span",{children:d})]}),r&&e.jsxs("div",{className:"p-4 bg-primary/5 border border-primary/20 rounded-2xl",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"إعادة تعيين كلمة المرور لـ:"}),e.jsx("p",{className:"text-sm font-black text-primary",children:r})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-black text-gray-700 dark:text-gray-300 mr-2",children:"كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{type:"button",onClick:()=>P(!i),className:"absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-primary transition-colors z-10","aria-label":i?"إخفاء كلمة المرور":"إظهار كلمة المرور",children:i?e.jsx(j,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})}),e.jsx("input",{id:"password",type:i?"text":"password",required:!0,value:s.password,onChange:a=>u({...s,password:a.target.value}),placeholder:"••••••••",className:"onboarding-input pl-14","aria-label":"كلمة المرور الجديدة","aria-required":"true","aria-invalid":d?"true":"false",minLength:8})]}),e.jsx(D,{strength:C,passwordLength:s.password.length})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-black text-gray-700 dark:text-gray-300 mr-2",children:"تأكيد كلمة المرور"}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{type:"button",onClick:()=>S(!o),className:"absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-accent1 transition-colors z-10","aria-label":o?"إخفاء كلمة المرور":"إظهار كلمة المرور",children:o?e.jsx(j,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})}),e.jsx("input",{id:"confirmPassword",type:o?"text":"password",required:!0,value:s.confirmPassword,onChange:a=>u({...s,confirmPassword:a.target.value}),placeholder:"••••••••",className:"onboarding-input pl-14","aria-label":"تأكيد كلمة المرور","aria-required":"true",minLength:8})]}),s.confirmPassword.length>0&&e.jsx("div",{className:"pt-1 px-1 animate-in fade-in duration-300",children:s.password===s.confirmPassword?e.jsxs("p",{className:"text-xs font-bold text-accent1 flex items-center gap-1.5",children:[e.jsx(y,{className:"w-3.5 h-3.5"}),"كلمات المرور متطابقة"]}):e.jsxs("p",{className:"text-xs font-bold text-accent2 flex items-center gap-1.5",children:[e.jsx(g,{className:"w-3.5 h-3.5"}),"كلمات المرور غير متطابقة"]})})]}),e.jsx("button",{type:"submit",disabled:p||!c||!r,className:"w-full py-4 bg-primary text-white rounded-2xl font-black text-sm shadow-xl shadow-primary/20 hover:scale-[1.02] active:scale-95 transition-all disabled:opacity-50 flex items-center justify-center gap-3","aria-label":"إعادة تعيين كلمة المرور",children:p?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"جاري المعالجة..."})]}):"إعادة تعيين كلمة المرور"}),e.jsx("div",{className:"pt-6 text-center",children:e.jsx("button",{type:"button",onClick:()=>x("/login"),className:"text-sm text-gray-500 dark:text-gray-400 font-bold hover:text-primary transition-colors",children:"العودة لتسجيل الدخول"})})]})})}export{G as default};

import{g as R,v as U,r as g,f as y,c as G,h as z,j as e,w as I,T as H,R as K}from"./index-CytmB-Er.js";import{A as W}from"./adminlayout-DIdHhvbo.js";import{A as X}from"./applayout-hmzBXZ1U.js";import{a as J}from"./helpers-CPSgdYRA.js";import{T as u}from"./textsadminpanel-DB4O06i_.js";import{I as Q,D as Z,A as ee,T as te}from"./table-cells-CvzEJ-64.js";import"./adslot-1WJBBd70.js";import"./sidebar-left-s-soE1BO.js";import"./loader-circle-Bj7yhw_M.js";import"./log-out-DPAkzXIl.js";import"./user-BVnW-pgT.js";import"./users-DikJyHif.js";import"./shield-alert-D3dSgJZt.js";import"./shield-overlay-jKLJv9mZ.js";import"./database-BnUETau0.js";import"./mail-iCRNgKv8.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],M=R("rotate-ccw",se);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],q=R("square-check-big",re);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],O=R("square",ae);function le(S){const{endpoint:p}=S,{showSuccess:x,showError:h,showConfirm:s}=U(),[m,k]=g.useState([]),[N,j]=g.useState({total:0,byType:{}}),[w,f]=g.useState(!0),[d,t]=g.useState([]),o=g.useCallback(async()=>{var l,r;try{f(!0);const c=await y.get(p);k(c.data||[]),j(c.stats||{total:0,byType:{}})}catch(c){h(((r=(l=c.response)==null?void 0:l.data)==null?void 0:r.error)||"فشل تحميل العناصر المحذوفة"),k([]),j({total:0,byType:{}})}finally{f(!1)}},[p,h]);return g.useEffect(()=>{o()},[o]),{items:m,stats:N,isLoading:w,selected:d,toggleSelect:l=>{t(r=>r.some(a=>a.type===l.type&&a.id===l.id)?r.filter(a=>!(a.type===l.type&&a.id===l.id)):[...r,l])},selectAll:()=>{d.length===m.length?t([]):t([...m])},restore:async(l,r)=>{var c,a;try{await y.post(`${p}/restore`,{type:l,id:r}),x("تم الاستعادة بنجاح"),o(),t(n=>n.filter(i=>!(i.type===l&&i.id===r)))}catch(n){h(((a=(c=n.response)==null?void 0:c.data)==null?void 0:a.error)||"فشل الاستعادة")}},forceDelete:async(l,r)=>{var a,n;if(await s({title:"حذف نهائي",message:"هل أنت متأكد من الحذف النهائي؟ لا يمكن التراجع عن هذا الإجراء.",isDestructive:!0}))try{await y.delete(`${p}/force`,{data:{type:l,id:r}}),x("تم الحذف نهائياً"),o(),t(i=>i.filter(b=>!(b.type===l&&b.id===r)))}catch(i){h(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.error)||"فشل الحذف")}},bulkRestore:async()=>{var l,r;if(d.length!==0)try{const c=d.map(n=>({type:n.type,id:n.id})),a=await y.post(`${p}/bulk-restore`,{items:c});x(`تم استعادة ${a.success} عنصر`),o(),t([])}catch(c){h(((r=(l=c.response)==null?void 0:l.data)==null?void 0:r.error)||"فشل الاستعادة الجماعية")}},bulkForceDelete:async()=>{var r,c;if(!(d.length===0||!await s({title:"حذف نهائي جماعي",message:`هل أنت متأكد من حذف ${d.length} عنصر نهائياً؟ لا يمكن التراجع عن هذا الإجراء.`,isDestructive:!0})))try{const a=d.map(i=>({type:i.type,id:i.id})),n=await y.delete(`${p}/bulk-force`,{data:{items:a}});x(`تم حذف ${n.success} عنصر نهائياً`),o(),t([])}catch(a){h(((c=(r=a.response)==null?void 0:r.data)==null?void 0:c.error)||"فشل الحذف الجماعي")}},emptyTrash:async()=>{var r,c;if(await s({title:"إفراغ سلة المحذوفات",message:"هل أنت متأكد من حذف جميع العناصر نهائياً؟ لا يمكن التراجع عن هذا الإجراء.",isDestructive:!0}))try{const a=await y.delete(`${p}/empty`);x(`تم حذف ${a.count} عنصر نهائياً`),o(),t([])}catch(a){h(((c=(r=a.response)==null?void 0:r.data)==null?void 0:c.error)||"فشل إفراغ السلة")}},refresh:o}}function je(){var f,d;const S=G(),{t:p}=z(),x=S.pathname.startsWith("/admin"),s=le({endpoint:x?"/admin/trash":"/app/trash"}),m=t=>{var o,T,C,E,v,_,L,A,l,r,c,a,n,i,b,D,Y,$,B,P,F;return x?{tenants:(C=(T=(o=u)==null?void 0:o.RECYCLE_BIN)==null?void 0:T.TYPES)==null?void 0:C.TENANTS,fonts:(_=(v=(E=u)==null?void 0:E.RECYCLE_BIN)==null?void 0:v.TYPES)==null?void 0:_.FONTS,languages:(l=(A=(L=u)==null?void 0:L.RECYCLE_BIN)==null?void 0:A.TYPES)==null?void 0:l.LANGUAGES,translations:(a=(c=(r=u)==null?void 0:r.RECYCLE_BIN)==null?void 0:c.TYPES)==null?void 0:a.TRANSLATIONS,users:(b=(i=(n=u)==null?void 0:n.RECYCLE_BIN)==null?void 0:i.TYPES)==null?void 0:b.USERS,ads:($=(Y=(D=u)==null?void 0:D.RECYCLE_BIN)==null?void 0:Y.TYPES)==null?void 0:$.ADS,support_tickets:(F=(P=(B=u)==null?void 0:B.RECYCLE_BIN)==null?void 0:P.TYPES)==null?void 0:F.SUPPORT_TICKETS}[t]||t:{support_tickets:"تذاكر الدعم",messages:"الرسائل",files:"الملفات"}[t]||t},k=t=>s.selected.some(o=>o.type===t.type&&o.id===t.id),N=e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-primary/5 rounded-3xl p-6 border border-primary/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 bg-primary/10 rounded-xl text-primary",children:e.jsx(I,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-xs font-black text-primary uppercase tracking-widest",children:"إحصائيات السلة"})]}),e.jsx("p",{className:"text-4xl font-black text-primary tracking-tighter",children:s.stats.total}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold mt-2",children:"إجمالي العناصر المحذوفة"})]}),Object.keys(s.stats.byType).length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest px-1",children:"التصنيف"}),e.jsx("div",{className:"space-y-2",children:Object.entries(s.stats.byType).map(([t,o])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700",children:[e.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:m(t)}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-50 dark:bg-dark-900 rounded-lg text-[10px] font-black text-primary border border-gray-100 dark:border-dark-700",children:o})]},t))})]}),s.stats.total>0&&e.jsxs("button",{onClick:s.emptyTrash,className:"w-full flex items-center justify-center gap-2 py-3.5 bg-red-600 text-white rounded-xl font-black text-xs hover:bg-red-700 transition-all shadow-xl shadow-red-100 group active:scale-[0.98]",children:[e.jsx(H,{className:"w-4 h-4 group-hover:rotate-12 transition-transform"}),"إفراغ السلة نهائياً"]}),s.selected.length>0&&e.jsxs("div",{className:"space-y-2 pt-4 border-t border-gray-200 dark:border-dark-700",children:[e.jsxs("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:[s.selected.length," محدد"]}),e.jsxs("button",{onClick:s.bulkRestore,className:"w-full flex items-center justify-center gap-2 py-3 bg-emerald-600 text-white rounded-xl font-black text-xs hover:bg-emerald-700 transition-all",children:[e.jsx(M,{className:"w-4 h-4"}),"استعادة المحدد"]}),e.jsxs("button",{onClick:s.bulkForceDelete,className:"w-full flex items-center justify-center gap-2 py-3 bg-red-600 text-white rounded-xl font-black text-xs hover:bg-red-700 transition-all",children:[e.jsx(I,{className:"w-4 h-4"}),"حذف المحدد نهائياً"]})]})]}),j=K.useMemo(()=>[{header:"",accessor:t=>e.jsx("button",{onClick:()=>s.toggleSelect(t),className:"w-5 h-5 flex items-center justify-center",children:k(t)?e.jsx(q,{className:"w-5 h-5 text-primary"}):e.jsx(O,{className:"w-5 h-5 text-gray-300 hover:text-gray-500"})}),width:"5%"},{header:"العنصر",accessor:t=>e.jsx(Q,{name:t.display_name,subtext:`${t.type.toUpperCase().slice(0,3)}-${t.id.toString().padStart(4,"0")}`}),exportValue:t=>t.display_name,width:"35%"},{header:"النوع",accessor:t=>e.jsx("span",{className:"inline-flex items-center px-4 py-1.5 bg-gray-50 dark:bg-dark-900 text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-dark-700 text-[10px] font-black uppercase tracking-tight rounded-lg",children:m(t.type)}),exportValue:t=>m(t.type),width:"15%"},{header:"تاريخ الحذف",accessor:t=>e.jsx(Z,{date:t.deleted_at,includeTime:!0}),exportValue:t=>J(t.deleted_at),width:"25%"},{header:"الإجراءات",accessor:t=>e.jsxs(ee,{children:[e.jsx("button",{onClick:()=>s.restore(t.type,t.id),className:"w-10 h-10 flex items-center justify-center text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl hover:bg-emerald-500 hover:text-white hover:scale-110 active:scale-95 transition-all shadow-sm",title:"استعادة",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>s.forceDelete(t.type,t.id),className:"w-10 h-10 flex items-center justify-center text-red-600 bg-red-50 dark:bg-red-900/20 rounded-xl hover:bg-red-500 hover:text-white hover:scale-110 active:scale-95 transition-all shadow-sm",title:"حذف نهائي",children:e.jsx(I,{className:"w-5 h-5"})})]}),width:"20%"}],[s.toggleSelect,s.restore,s.forceDelete,s.selected,m]),w=e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-700 h-full flex flex-col",children:[s.items.length>0&&e.jsxs("div",{className:"flex items-center gap-3 px-4",children:[e.jsxs("button",{onClick:s.selectAll,className:"flex items-center gap-2 text-sm font-bold text-gray-600 dark:text-gray-400 hover:text-primary transition-colors",children:[s.selected.length===s.items.length?e.jsx(q,{className:"w-5 h-5 text-primary"}):e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:s.selected.length===s.items.length?"إلغاء تحديد الكل":"تحديد الكل"})]}),s.selected.length>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:["(",s.selected.length," محدد)"]})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-transparent",children:e.jsx(te,{columns:j,data:s.items,isLoading:s.isLoading,emptyMessage:"السلة فارغة",exportFileName:"سلة_المحذوفات"})})]});return x?e.jsx(W,{title:(d=(f=u)==null?void 0:f.TITLES)==null?void 0:d.RECYCLE_BIN,leftSidebarContent:N,children:w}):e.jsx(X,{title:p("trash.title","سلة المحذوفات"),leftSidebarContent:N,children:w})}export{je as default};

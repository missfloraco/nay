import{f as I,t as G,r as b,e as k,c as K,h as W,j as e,v as D,T as X,R as J}from"./index-CyxQwsQl.js";import{A as Q}from"./adminlayout-BZTWR09H.js";import{A as Z}from"./applayout-NsEbGuby.js";import{a as ee}from"./helpers-CPSgdYRA.js";import{T as g}from"./textsadminpanel-DB4O06i_.js";import{T as te}from"./table-Bgq6U4EG.js";import{I as se,D as re,A as ae}from"./table-cells-BSPpJxzy.js";import{D as le}from"./drawer-Bj6KWlWm.js";import{R as q}from"./rotate-ccw-D39Bn6F_.js";import"./adslot-DC0mcUoM.js";import"./users-BsWlUMcl.js";import"./shield-B62tIG1s.js";import"./sparkles-ClcDe-Ep.js";import"./shield-alert-Mqum-lvM.js";import"./log-out-DA5HdhrL.js";import"./shield-overlay-Cc4mKCy5.js";import"./shield-check-C6HDylmK.js";import"./database-Bma1fOMh.js";import"./chevron-right-Wgfm7FsJ.js";import"./mail-BuZJhIit.js";import"./user-CAZ9w-Ov.js";import"./theme-toggle-DmE4dG8g.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],oe=I("settings-2",ce);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],U=I("square-check-big",ne);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],H=I("square",ie);function de(T){const{endpoint:m}=T,{showSuccess:y,showError:n,showConfirm:u}=G(),[N,s]=b.useState([]),[f,w]=b.useState({total:0,byType:{}}),[C,S]=b.useState(!0),[x,d]=b.useState([]),p=b.useCallback(async()=>{var l,r;try{S(!0);const c=await k.get(m);s(c.data||[]),w(c.stats||{total:0,byType:{}})}catch(c){n(((r=(l=c.response)==null?void 0:l.data)==null?void 0:r.error)||"فشل تحميل العناصر المحذوفة"),s([]),w({total:0,byType:{}})}finally{S(!1)}},[m,n]);return b.useEffect(()=>{p()},[p]),{items:N,stats:f,isLoading:C,selected:x,toggleSelect:l=>{d(r=>r.some(a=>a.type===l.type&&a.id===l.id)?r.filter(a=>!(a.type===l.type&&a.id===l.id)):[...r,l])},selectAll:()=>{x.length===N.length?d([]):d([...N])},restore:async(l,r)=>{var c,a;try{await k.post(`${m}/restore`,{type:l,id:r}),y("تم الاستعادة بنجاح"),p(),d(o=>o.filter(i=>!(i.type===l&&i.id===r)))}catch(o){n(((a=(c=o.response)==null?void 0:c.data)==null?void 0:a.error)||"فشل الاستعادة")}},forceDelete:async(l,r)=>{var a,o;if(await u({title:"حذف نهائي",message:"هل أنت متأكد من الحذف النهائي؟ لا يمكن التراجع عن هذا الإجراء.",isDestructive:!0}))try{await k.delete(`${m}/force`,{data:{type:l,id:r}}),y("تم الحذف نهائياً"),p(),d(i=>i.filter(j=>!(j.type===l&&j.id===r)))}catch(i){n(((o=(a=i.response)==null?void 0:a.data)==null?void 0:o.error)||"فشل الحذف")}},bulkRestore:async()=>{var l,r;if(x.length!==0)try{const c=x.map(o=>({type:o.type,id:o.id})),a=await k.post(`${m}/bulk-restore`,{items:c});y(`تم استعادة ${a.success} عنصر`),p(),d([])}catch(c){n(((r=(l=c.response)==null?void 0:l.data)==null?void 0:r.error)||"فشل الاستعادة الجماعية")}},bulkForceDelete:async()=>{var r,c;if(!(x.length===0||!await u({title:"حذف نهائي جماعي",message:`هل أنت متأكد من حذف ${x.length} عنصر نهائياً؟ لا يمكن التراجع عن هذا الإجراء.`,isDestructive:!0})))try{const a=x.map(i=>({type:i.type,id:i.id})),o=await k.delete(`${m}/bulk-force`,{data:{items:a}});y(`تم حذف ${o.success} عنصر نهائياً`),p(),d([])}catch(a){n(((c=(r=a.response)==null?void 0:r.data)==null?void 0:c.error)||"فشل الحذف الجماعي")}},emptyTrash:async()=>{var r,c;if(await u({title:"إفراغ سلة المحذوفات",message:"هل أنت متأكد من حذف جميع العناصر نهائياً؟ لا يمكن التراجع عن هذا الإجراء.",isDestructive:!0}))try{const a=await k.delete(`${m}/empty`);y(`تم حذف ${a.count} عنصر نهائياً`),p(),d([])}catch(a){n(((c=(r=a.response)==null?void 0:r.data)==null?void 0:c.error)||"فشل إفراغ السلة")}},refresh:p}}function Ie(){var p,v;const T=K(),{t:m}=W(),[y,n]=b.useState(!1),u=T.pathname.startsWith("/admin"),s=de({endpoint:u?"/admin/trash":"/app/trash"}),f=t=>{var h,E,L,_,A,l,r,c,a,o,i,j,R,Y,$,O,B,P,F,M,V;return u?{tenants:(L=(E=(h=g)==null?void 0:h.RECYCLE_BIN)==null?void 0:E.TYPES)==null?void 0:L.TENANTS,fonts:(l=(A=(_=g)==null?void 0:_.RECYCLE_BIN)==null?void 0:A.TYPES)==null?void 0:l.FONTS,languages:(a=(c=(r=g)==null?void 0:r.RECYCLE_BIN)==null?void 0:c.TYPES)==null?void 0:a.LANGUAGES,translations:(j=(i=(o=g)==null?void 0:o.RECYCLE_BIN)==null?void 0:i.TYPES)==null?void 0:j.TRANSLATIONS,users:($=(Y=(R=g)==null?void 0:R.RECYCLE_BIN)==null?void 0:Y.TYPES)==null?void 0:$.USERS,ads:(P=(B=(O=g)==null?void 0:O.RECYCLE_BIN)==null?void 0:B.TYPES)==null?void 0:P.ADS,support_tickets:(V=(M=(F=g)==null?void 0:F.RECYCLE_BIN)==null?void 0:M.TYPES)==null?void 0:V.SUPPORT_TICKETS}[t]||t:{support_tickets:"تذاكر الدعم",messages:"الرسائل",files:"الملفات"}[t]||t},w=t=>s.selected.some(h=>h.type===t.type&&h.id===t.id),C=e.jsxs("div",{className:"space-y-8 p-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-2xl text-primary",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 dark:text-white leading-none",children:"خيارات السلة"}),e.jsx("p",{className:"text-xs font-bold text-gray-400 mt-1",children:"إحصائيات وتحكم سريع"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-dark-900/40 rounded-[2rem] p-8 border border-gray-100 dark:border-dark-800",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-4 block",children:"إجمالي المحذوفات"}),e.jsx("p",{className:"text-5xl font-black text-primary tracking-tighter",children:s.stats.total}),e.jsx("p",{className:"text-xs text-gray-400 font-bold mt-3",children:"عنصر ينتظر المعالجة"})]}),Object.keys(s.stats.byType).length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest px-1",children:"التصنيف حسب النوع"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(s.stats.byType).map(([t,h])=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white dark:bg-dark-800/60 rounded-2xl border border-gray-100 dark:border-dark-700/50",children:[e.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-300",children:f(t)}),e.jsx("span",{className:"px-3 py-1 bg-gray-50 dark:bg-dark-950 rounded-lg text-[10px] font-black text-primary border border-gray-100 dark:border-dark-700",children:h})]},t))})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-100 dark:border-dark-800 space-y-3",children:[s.stats.total>0&&e.jsxs("button",{onClick:()=>{s.emptyTrash(),n(!1)},className:"w-full h-14 flex items-center justify-center gap-3 bg-red-600 text-white rounded-2xl font-black text-sm hover:bg-red-700 transition-all shadow-xl shadow-red-500/10 group active:scale-[0.98]",children:[e.jsx(X,{className:"w-5 h-5 group-hover:rotate-12 transition-transform"}),"إفراغ السلة نهائياً"]}),s.selected.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1 pt-2",children:["تحكم بالمحدد (",s.selected.length,")"]}),e.jsxs("button",{onClick:()=>{s.bulkRestore(),n(!1)},className:"w-full h-14 flex items-center justify-center gap-3 bg-emerald-600 text-white rounded-2xl font-black text-sm hover:bg-emerald-700 transition-all shadow-xl shadow-emerald-500/10",children:[e.jsx(q,{className:"w-5 h-5"}),"استعادة العناصر المحددة"]}),e.jsxs("button",{onClick:()=>{s.bulkForceDelete(),n(!1)},className:"w-full h-14 flex items-center justify-center gap-3 bg-red-50 text-red-600 border border-red-100 rounded-2xl font-black text-sm hover:bg-red-100 transition-all",children:[e.jsx(D,{className:"w-5 h-5"}),"حذف العناصر المحددة نهائياً"]})]})]})]}),S=J.useMemo(()=>[{header:"",accessor:t=>e.jsx("button",{onClick:()=>s.toggleSelect(t),className:"w-5 h-5 flex items-center justify-center",children:w(t)?e.jsx(U,{className:"w-5 h-5 text-primary"}):e.jsx(H,{className:"w-5 h-5 text-gray-300 hover:text-gray-500"})}),width:"5%"},{header:"العنصر",accessor:t=>e.jsx(se,{name:t.display_name,subtext:`${t.type.toUpperCase().slice(0,3)}-${t.id.toString().padStart(4,"0")}`}),exportValue:t=>t.display_name,width:"35%"},{header:"النوع",accessor:t=>e.jsx("span",{className:"inline-flex items-center px-4 py-1.5 bg-gray-50 dark:bg-dark-900 text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-dark-700 text-[10px] font-black uppercase tracking-tight rounded-lg",children:f(t.type)}),exportValue:t=>f(t.type),width:"15%"},{header:"تاريخ الحذف",accessor:t=>e.jsx(re,{date:t.deleted_at,includeTime:!0}),exportValue:t=>ee(t.deleted_at),width:"25%"},{header:"الإجراءات",accessor:t=>e.jsxs(ae,{children:[e.jsx("button",{onClick:()=>s.restore(t.type,t.id),className:"w-10 h-10 flex items-center justify-center text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl hover:bg-emerald-500 hover:text-white hover:scale-110 active:scale-95 transition-all shadow-sm",title:"استعادة",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>s.forceDelete(t.type,t.id),className:"w-10 h-10 flex items-center justify-center text-red-600 bg-red-50 dark:bg-red-900/20 rounded-xl hover:bg-red-500 hover:text-white hover:scale-110 active:scale-95 transition-all shadow-sm",title:"حذف نهائي",children:e.jsx(D,{className:"w-5 h-5"})})]}),width:"20%"}],[s.toggleSelect,s.restore,s.forceDelete,s.selected,f]),x=e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-700 h-full flex flex-col",children:[s.items.length>0&&e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2",children:[e.jsxs("button",{onClick:s.selectAll,className:"flex items-center gap-3 px-4 py-2 bg-gray-50 dark:bg-dark-900 rounded-xl border border-gray-100 dark:border-dark-800 text-sm font-bold text-gray-600 dark:text-gray-400 hover:text-primary transition-all active:scale-95",children:[s.selected.length===s.items.length?e.jsx(U,{className:"w-5 h-5 text-primary"}):e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:s.selected.length===s.items.length?"إلغاء تحديد الكل":"تحديد جميع المعروض"})]}),s.selected.length>0&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary/10 text-primary rounded-lg text-xs font-black",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary animate-pulse"}),s.selected.length," محدد حالياً"]})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-transparent",children:e.jsx(te,{columns:S,data:s.items,isLoading:s.isLoading,emptyMessage:"السلة فارغة حالياً",exportFileName:"سلة_المحذوفات"})}),e.jsx(le,{isOpen:y,onClose:()=>n(!1),title:"خيارات السلة",children:C})]}),d=e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-6 h-12 bg-white dark:bg-dark-800 border-2 border-gray-100 dark:border-dark-700 rounded-2xl text-sm font-black text-gray-700 dark:text-gray-200 hover:border-primary/30 hover:text-primary transition-all active:scale-95 shadow-sm shadow-gray-200/50",children:[e.jsx(oe,{size:18,className:"text-primary"}),e.jsx("span",{children:"خيارات السلة"}),s.selected.length>0&&e.jsx("span",{className:"flex items-center justify-center w-5 h-5 bg-primary text-white text-[10px] rounded-full",children:s.selected.length})]});return u?e.jsx(Q,{title:(v=(p=g)==null?void 0:p.TITLES)==null?void 0:v.RECYCLE_BIN,actions:d,hideLeftSidebar:!0,children:x}):e.jsx(Z,{title:m("trash.title","سلة المحذوفات"),actions:d,hideLeftSidebar:!0,children:x})}export{Ie as default};

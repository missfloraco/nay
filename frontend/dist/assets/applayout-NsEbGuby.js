import{a as k,j as e,T as E,u as R,h as q,d as $,p as D,O as M,c as z,v as F,L as j,l as U,e as w}from"./index-CyxQwsQl.js";import{u as y,P as v,A as W}from"./adslot-DC0mcUoM.js";import{M as _,H,D as N,L as K,C as V,a as Q,B as Y}from"./drawer-Bj6KWlWm.js";import{S as G}from"./shield-alert-Mqum-lvM.js";import{L as J}from"./log-out-DA5HdhrL.js";import{S as X}from"./shield-overlay-Cc4mKCy5.js";import{L as Z}from"./sparkles-ClcDe-Ep.js";const ee=({tenantName:n,onExit:i})=>{const{isImpersonating:m}=k();return m?e.jsxs("div",{className:"fixed top-0 left-0 right-0 z-[10000] animate-in slide-in-from-top duration-500",children:[e.jsxs("div",{className:"bg-gradient-to-r from-accent2 to-red-600 text-white px-4 py-2.5 shadow-2xl flex items-center justify-between backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white/20 p-2 rounded-xl",children:e.jsx(G,{className:"w-5 h-5 text-white animate-pulse"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-black tracking-tight flex items-center gap-2",children:["وضع محاكاة النظام (Impersonation Mode)",e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded text-[10px] uppercase",children:"للعرض فقط"})]}),e.jsxs("p",{className:"text-[10px] font-bold opacity-80 uppercase tracking-widest",children:["أنت تشاهد الآن متجر: ",e.jsx("span",{className:"underline",children:n})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"hidden md:flex flex-col items-end mr-4",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-tighter opacity-60",children:"الأمان"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-bold leading-none text-white/90",children:[e.jsx(E,{className:"w-3 h-3 text-white animate-pulse"}),"وصول محدود للمشرف (للعرض فقط)"]})]}),e.jsxs("button",{onClick:i,className:"bg-white text-accent2 px-5 py-2 rounded-xl font-black text-xs hover:bg-gray-100 transition-all flex items-center gap-2 shadow-lg hover:scale-105 active:scale-95",children:[e.jsx(J,{className:"w-4 h-4"}),"إنهاء المحاكاة"]})]})]}),e.jsx("div",{className:"h-[2px] w-full bg-white/20 blur-[1px]"})]}):null},de=({children:n,title:i="",noPadding:m=!1,leftSidebarContent:o})=>{var b;const{user:c,tenant:r,isImpersonating:g,logout:u}=k(),{user:C}=R(),{settings:ae,isAdBlockActive:A,isCheckingAdBlock:L}=q(),{t:l}=$(),{primaryAction:s}=D(),{isRightDrawerOpen:I,isLeftDrawerOpen:S,closeDrawers:t,toggleRightDrawer:se}=M(),O=g||!!C,f=z(),P=async()=>{try{await u(!1),window.location.href="/admin/tenants"}catch(a){U.error("Exit impersonation failed",a),window.location.href="/admin/tenants"}},{data:d}=y({queryKey:["support-notifications-count"],queryFn:()=>w.get("/app/support/notifications/support"),refetchInterval:5e3,enabled:!!c}),T=(d==null?void 0:d.count)||0,{data:x}=y({queryKey:["trash-count"],queryFn:()=>w.get("/app/trash"),refetchInterval:1e4,enabled:!!c}),B=((b=x==null?void 0:x.stats)==null?void 0:b.total)||0,h=[{icon:_,label:l("tenant.NAV.SUPPORT","رسائل الدعم"),path:"/app/support/messages",color:"text-[#fb005e]",badge:T},{icon:F,label:l("tenant.NAV.RECYCLE_BIN","سلة المحذوفات"),path:"/app/trash",color:"text-red-600 font-black",badge:B}];return e.jsxs("div",{className:`layout-root transition-colors duration-500 ${g?"pt-[64px]":""}`,dir:"rtl",children:[!L&&A&&e.jsx(X,{}),e.jsx(ee,{tenantName:(r==null?void 0:r.name)||"...",onExit:P}),e.jsx(H,{onMenuClick:()=>{},className:"global-header",title:i||""}),e.jsxs("div",{className:"main-content-wrapper",children:[e.jsxs("aside",{className:"desktop-sidebar bg-white dark:bg-dark-900 border-l border-gray-200 dark:border-dark-700 z-40 transition-all duration-500 ease-in-out flex flex-col w-[250px]",children:[e.jsx("nav",{className:"flex-1 overflow-y-auto no-scrollbar p-6 space-y-1.5",children:h.map(a=>{const p=f.pathname.startsWith(a.path);return e.jsx("div",{className:"relative group/item",children:e.jsxs(j,{to:a.path,className:`flex items-center gap-4 px-4 py-3.5 rounded-2xl transition-all duration-300 font-bold group relative overflow-hidden
                                        ${p?"bg-primary text-white shadow-lg shadow-primary/30 active-nav-item":"text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-dark-800/50 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(a.icon,{className:"w-5 h-5 transition-all duration-500 scale-110"}),e.jsx("span",{className:"sidebar-label-text text-sm flex-1",children:a.label}),a.badge>0&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] font-bold rounded-full min-w-[20px] h-5 flex items-center justify-center px-1 animate-pulse",children:a.badge>9?"9+":a.badge})]})},a.path)})}),e.jsx("div",{className:"flex flex-col border-t border-gray-200 dark:border-dark-700 bg-gray-50/30 dark:bg-dark-800/20",children:e.jsx("div",{className:"h-[90px] px-6 flex items-center justify-center",children:s?e.jsxs("button",{type:s.type||"button",form:s.form,onClick:s.onClick,disabled:s.disabled||s.loading,className:`flex items-center justify-center gap-3 w-full py-3.5 px-6 ${s.variant==="danger"?"bg-red-600 shadow-red-500/20":"bg-primary shadow-primary/30"} text-white rounded-2xl shadow-lg transition-all font-black hover:scale-[1.02] active:scale-95 disabled:opacity-50`,children:[s.loading?e.jsx(Z,{className:"w-5 h-5 animate-spin"}):s.icon?e.jsx(s.icon,{className:"w-5 h-5"}):e.jsx(v,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:s.label})]}):null})})]}),e.jsx(N,{isOpen:I,onClose:t,side:"right",title:l("common.navigation","التنقل الرئيسي"),children:e.jsxs("nav",{className:"p-6 space-y-1.5 h-full flex flex-col",children:[e.jsx("div",{className:"flex-1 space-y-1.5",children:h.map(a=>{const p=f.pathname.startsWith(a.path);return e.jsxs(j,{to:a.path,onClick:t,className:`flex items-center gap-4 px-4 py-3.5 rounded-2xl transition-all duration-300 font-bold
                                        ${p?"bg-primary text-white shadow-lg shadow-primary/30":"text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-dark-800/50 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(a.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm flex-1",children:a.label}),a.badge>0&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] font-bold rounded-full min-w-[20px] h-5 flex items-center justify-center px-1",children:a.badge>9?"9+":a.badge})]},a.path)})}),s&&e.jsx("div",{className:"pt-6 border-t border-gray-100 dark:border-white/5 mt-auto",children:e.jsxs("button",{onClick:()=>{var a;(a=s.onClick)==null||a.call(s),t()},className:`flex items-center justify-center gap-3 w-full py-4 px-6 ${s.variant==="danger"?"bg-red-600":"bg-primary"} text-white rounded-2xl shadow-lg font-black transition-all`,children:[s.icon?e.jsx(s.icon,{className:"w-5 h-5"}):e.jsx(v,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:s.label})]})})]})}),o&&e.jsx(N,{isOpen:S,onClose:t,side:"left",title:l("common.options","خيارات إضافية"),children:e.jsx("div",{className:"h-full flex flex-col py-4",onClick:t,children:o})}),e.jsx("div",{className:"content-area-main relative overflow-hidden bg-gray-50 dark:bg-dark-950 flex-1",children:e.jsx("main",{className:"h-full relative p-4",children:e.jsx("div",{className:"page-frame-container w-full h-full bg-white dark:bg-dark-900 flex flex-col overflow-auto no-scrollbar p-0",children:n})})}),e.jsx(K,{children:o})]}),e.jsx("footer",{className:"global-footer flex h-[90px] border-t border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 items-center justify-between transition-all z-50",children:e.jsxs("div",{className:"flex h-full items-center w-full",children:[e.jsx(V,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center overflow-hidden h-full",children:e.jsx(W,{placement:"ad_footer_leaderboard",className:"w-full h-full",showPlaceholder:!1})}),!O&&e.jsx(Q,{type:"tenant",tenant:r})]})}),e.jsx("div",{className:"mobile-only",children:e.jsx(Y,{items:h,user:c,onLogout:()=>u(!1),settingsPath:"/app/settings"})})]})};export{de as A};

import{f as D,e as m,r as d,t as T,j as e,X as F,h as O,p as P,l as U}from"./index-3tzHmsOf.js";import{A as R,M as G}from"./adminlayout-ZagtXe8m.js";import{T as y}from"./textsadminpanel-DB4O06i_.js";import{I as V,A as z,T as q}from"./table-cells-0QReMnwe.js";import{E as K,D as X}from"./btn-crud-CvLbGUX8.js";import{I as w}from"./input-field-CqDw_XU4.js";import{P as A}from"./adslot-DgJhm0dE.js";import{I as E}from"./image-BNsNIQN0.js";import{T as H}from"./type-pMfRYGVt.js";import{L as W}from"./sparkles-BZvr4uos.js";import{L as I}from"./link-B4xk6IvH.js";import{C as J}from"./check-B32IzpdO.js";import{S as Q}from"./save-CtIa-MK8.js";import{S as Y}from"./shield-C-QUnZFc.js";import"./sidebar-left-SDr9qEmE.js";import"./helpers-CPSgdYRA.js";import"./user-BF6dZPLy.js";import"./log-out-DEKz7YE3.js";import"./users-m4cUupYH.js";import"./database-BLedNJg5.js";import"./chevron-right-BQpY62PU.js";import"./mail-wdynseuz.js";import"./eye-KtuTuuxE.js";import"./sun-BINGn8lG.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],ee=D("code",Z);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],te=D("pen",ae),g={getAll:async()=>await m.get("/admin/ads"),getActive:async()=>await m.get("/ads/active"),create:async r=>await m.post("/admin/ads",r),update:async(r,i)=>await m.put(`/admin/ads/${r}`,i),delete:async r=>await m.delete(`/admin/ads/${r}`),toggleAdBlock:async r=>m.post("/admin/ads/toggle-adblock",{enabled:r}),uploadImage:async r=>{const i=new FormData;return i.append("image",r),await m.post("/admin/ads/upload",i,{headers:{"Content-Type":"multipart/form-data"}})}};function re(){const[r,i]=d.useState([]),[b,h]=d.useState(!0),{showSuccess:x,showError:c,showConfirm:u}=T(),[l,p]=d.useState(!1),[t,s]=d.useState({name:"",placement:"ad_landing_top",type:"script",content:"",redirect_url:"",is_active:!0}),[f,N]=d.useState(!1),v=async()=>{try{h(!0);const a=await g.getAll();i(a)}catch{c("فشل تحميل الإعلانات")}finally{h(!1)}};d.useEffect(()=>{v()},[]);const j=()=>{s({name:"",placement:"ad_landing_top",type:"script",content:"",redirect_url:"",is_active:!0}),p(!1)},L=async a=>{if(a&&a.preventDefault(),!t.name||!t.content){c("يرجى ملء جميع الحقول المطلوبة");return}N(!0);try{t.id?(await g.update(t.id,t),x("تم تحديث الإعلان بنجاح")):(await g.create(t),x("تم إنشاء الإعلان بنجاح")),j(),v()}catch{c("حدث خطأ أثناء الحفظ")}finally{N(!1)}},M=async a=>{if(await u({title:"حذف الإعلان",message:"هل أنت متأكد من حذف هذا الإعلان؟ لا يمكن التراجع عن هذا الإجراء.",confirmLabel:"نعم، احذف",cancelLabel:"إلغاء",variant:"danger"}))try{await g.delete(a),x("تم حذف الإعلان بنجاح"),v()}catch{c("فشل حذف الإعلان")}},k=[{value:"ad_landing_top",label:"أعلى صفحة الهبوط"},{value:"ad_landing_footer",label:"أسفل صفحة الهبوط"},{value:"ad_sidebar_square",label:"الشريط الجانبي"},{value:"ad_footer_leaderboard",label:"فوتر المشتركين"}],$=d.useMemo(()=>[{header:"الإعلان",accessor:a=>e.jsx(V,{name:a.name,avatar:a.type==="image"?a.content:void 0,subtext:`${a.type.toUpperCase()} UNIT • ID: ${a.id}`}),exportValue:a=>a.name,className:"min-w-[250px]"},{header:"مكان الظهور",accessor:a=>{var n;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary/40"}),e.jsx("span",{className:"text-sm font-black text-gray-600 dark:text-gray-400",children:((n=k.find(o=>o.value===a.placement))==null?void 0:n.label)||a.placement})]})},exportValue:a=>{var n;return((n=k.find(o=>o.value===a.placement))==null?void 0:n.label)||a.placement}},{header:"النوع",accessor:a=>e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-dark-800 rounded-xl text-[10px] font-black text-gray-500 dark:text-gray-400 inline-block uppercase tracking-widest",children:a.type}),exportValue:a=>a.type},{header:"الإحصائيات",accessor:a=>{var n,o;return e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-lg font-black text-blue-500 leading-none",children:((n=a.stats)==null?void 0:n.impressions)||0}),e.jsx("div",{className:"text-[8px] font-black text-gray-400 uppercase tracking-widest",children:"View"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-100 dark:bg-white/5"}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-lg font-black text-emerald-500 leading-none",children:((o=a.stats)==null?void 0:o.clicks)||0}),e.jsx("div",{className:"text-[8px] font-black text-gray-400 uppercase tracking-widest",children:"Click"})]})]})},className:"text-center"},{header:"الحالة",accessor:a=>e.jsx("div",{className:"flex justify-center",children:a.is_active?e.jsxs("div",{className:"flex items-center gap-3 px-5 py-2 bg-green-50 dark:bg-green-500/10 text-green-600 rounded-[1.5rem] text-[11px] font-black border border-green-100 dark:border-green-500/20 shadow-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse shadow-[0_0_10px_rgba(34,197,94,0.5)]"}),"مفعل"]}):e.jsxs("div",{className:"flex items-center gap-3 px-5 py-2 bg-gray-100 dark:bg-dark-800 text-gray-400 rounded-[1.5rem] text-[11px] font-black border border-gray-200 dark:border-white/5 opacity-60",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),"متوقف"]})}),className:"text-center"},{header:"التحكم",accessor:a=>e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(K,{type:"icon",onClick:()=>{s(a),p(!0)}}),e.jsx(X,{type:"icon",onClick:()=>M(a.id)})]})}),className:"text-left"}],[k]),[_,S]=d.useState(!1),B=async a=>{var o;const n=(o=a.target.files)==null?void 0:o[0];if(n){S(!0);try{const C=await g.uploadImage(n);s({...t,content:C.url}),x("تم رفع الصورة بنجاح")}catch{c("فشل رفع الصورة")}finally{S(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(q,{columns:$,data:r,isLoading:b,exportFileName:"جدول_الإعلانات",emptyMessage:"لا توجد إعلانات مخصصة بعد"}),e.jsx("div",{className:"mt-8 flex justify-end px-6 md:px-10 pb-10",children:e.jsxs("button",{onClick:()=>{p(!0),s({name:"",placement:"ad_landing_top",type:"script",content:"",redirect_url:"",is_active:!0})},className:"flex items-center gap-3 px-10 py-5 bg-primary text-white rounded-[2rem] font-black shadow-2xl shadow-primary/30 hover:scale-105 transition-all active:scale-95 group",children:[e.jsx(A,{className:"w-7 h-7 group-hover:rotate-90 transition-transform duration-300"}),e.jsx("span",{className:"text-lg",children:"إضافة إعلان جديد"})]})})]}),l&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-dark-900 rounded-[3rem] w-full max-w-xl shadow-2xl overflow-hidden border border-gray-100 dark:border-white/5 flex flex-col animate-in zoom-in-95 duration-500 max-h-[90vh]",onMouseDown:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"px-10 py-8 border-b border-gray-50 dark:border-white/10 flex items-center justify-between bg-gray-50/50 dark:bg-dark-950/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-2xl text-primary",children:t.id?e.jsx(te,{className:"w-6 h-6"}):e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 dark:text-white",children:t.id?"تعديل الإعلان":"إضافة إعلان جديد"}),e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mt-0.5",children:"تفاصيل الحملة الإعلانية"})]})]}),e.jsx("button",{onClick:j,className:"p-3 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-400 hover:text-red-500 rounded-2xl transition-all",children:e.jsx(F,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:L,className:"flex-1 overflow-y-auto p-10 space-y-6 no-scrollbar",children:[e.jsx(w,{label:"اسم الحملة",value:t.name,onChange:a=>s({...t,name:a.target.value}),placeholder:"مثال: عرض الصيف 2024",required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"مكان الظهور"}),e.jsx("select",{value:t.placement,onChange:a=>s({...t,placement:a.target.value}),className:"w-full px-6 py-5 rounded-2xl border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all font-bold",children:k.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"الحالة"}),e.jsxs("div",{className:"flex p-1 bg-gray-50 dark:bg-dark-950 rounded-2xl border border-gray-100 dark:border-white/10 h-[62px]",children:[e.jsx("button",{type:"button",onClick:()=>s({...t,is_active:!0}),className:`flex-1 rounded-xl text-xs font-black transition-all ${t.is_active?"bg-white dark:bg-dark-700 shadow-sm text-green-500":"text-gray-400 opacity-50"}`,children:"نشط"}),e.jsx("button",{type:"button",onClick:()=>s({...t,is_active:!1}),className:`flex-1 rounded-xl text-xs font-black transition-all ${t.is_active?"text-gray-400 opacity-50":"bg-white dark:bg-dark-700 shadow-sm text-red-500"}`,children:"متوقف"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"نوع الإعلان"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{id:"script",label:"Script",icon:ee},{id:"image",label:"Image",icon:E},{id:"html",label:"HTML",icon:H}].map(a=>e.jsxs("button",{type:"button",onClick:()=>s({...t,type:a.id}),className:`flex flex-col items-center gap-3 p-5 rounded-[2rem] border-2 transition-all group ${t.type===a.id?"border-primary bg-primary/5 text-primary":"border-gray-50 dark:border-white/10 text-gray-400"}`,children:[e.jsx(a.icon,{className:`w-6 h-6 ${t.type===a.id?"":"grayscale opacity-50"}`}),e.jsx("span",{className:"text-[10px] font-black tracking-widest uppercase",children:a.label})]},a.id))})]}),t.type==="image"?e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"رفع صورة الإعلان"}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"file",onChange:B,accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",disabled:_}),e.jsx("div",{className:"w-full h-40 rounded-[2rem] border-2 border-dashed border-gray-100 dark:border-white/10 bg-gray-50/30 dark:bg-dark-950 flex flex-col items-center justify-center gap-3 group-hover:border-primary/50 transition-all overflow-hidden relative",children:_?e.jsx(W,{className:"w-8 h-8 text-primary animate-spin"}):t.content&&t.content.startsWith("http")?e.jsx("img",{src:t.content,className:"w-full h-full object-contain p-4",alt:"Preview"}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-10 h-10 text-gray-300"}),e.jsx("span",{className:"text-xs font-black text-gray-400",children:"اسحب الصورة هنا أو اضغط للرفع"})]})})]})]}),e.jsx(w,{label:"أو رابط الصورة المباشر",value:t.content,onChange:a=>s({...t,content:a.target.value}),placeholder:"https://example.com/banner.jpg",icon:I,className:"ltr"})]}):e.jsxs("div",{className:"space-y-2 animate-in fade-in duration-500",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] px-1",children:"الكود الإعلاني"}),e.jsx("textarea",{value:t.content,onChange:a=>s({...t,content:a.target.value}),className:"w-full h-40 px-8 py-5 rounded-[2rem] border border-gray-100 dark:border-white/10 bg-gray-50/50 dark:bg-dark-950 outline-none focus:ring-4 focus:ring-primary/10 transition-all text-xs ltr no-scrollbar",placeholder:t.type==="script"?'<script src="..."><\/script>':"<div>...</div>",required:!0})]}),t.type==="image"&&e.jsx(w,{label:"رابط التوجيه (Redirect URL)",value:t.redirect_url||"",onChange:a=>s({...t,redirect_url:a.target.value}),placeholder:"https://example.com/buy-now",icon:I,className:"ltr"}),e.jsxs("div",{className:"pt-6 flex gap-4",children:[e.jsxs("button",{type:"submit",disabled:f,className:"flex-1 py-5 bg-primary text-white rounded-[2rem] font-black shadow-xl shadow-primary/20 hover:scale-[1.02] active:scale-95 transition-all text-xl flex items-center justify-center gap-4 group disabled:opacity-50",children:[f?e.jsx("div",{className:"w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(J,{className:"w-7 h-7 group-hover:scale-125 transition-transform"}),e.jsx("span",{children:t.id?"حفظ التغييرات":"نشر الإعلان"})]}),e.jsx("button",{type:"button",onClick:j,className:"px-8 bg-gray-100 dark:bg-dark-800 text-gray-700 dark:text-gray-300 rounded-[2rem] font-bold hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors",children:"إلغاء"})]})]})]})})]})}function Ae(){const{settings:r,updateSettings:i}=O(),{showSuccess:b,showError:h}=T(),{setPrimaryAction:x}=P(),[c,u]=d.useState(!1),[l,p]=d.useState({adblock_enabled:r.adblock_enabled==="true"||r.adblock_enabled===!0||r.adblock_enabled==="1"||r.adblock_enabled===1});d.useEffect(()=>{p({adblock_enabled:r.adblock_enabled==="true"||r.adblock_enabled===!0||r.adblock_enabled==="1"||r.adblock_enabled===1})},[r.adblock_enabled]);const t=async s=>{u(!0);try{await g.toggleAdBlock(l.adblock_enabled),await i({}),b(y.MESSAGES.SUCCESS)}catch(f){U.error(f),h(y.MESSAGES.ERROR)}finally{u(!1)}};return d.useEffect(()=>(x({label:c?"جاري الحفظ...":"حفظ الإعدادات",onClick:()=>t(),icon:Q,loading:c,variant:"primary"}),()=>x(null)),[c,l]),e.jsx(R,{title:"إدارة الإعلانات",noPadding:!0,children:e.jsxs("div",{className:"h-full flex flex-col animate-in fade-in duration-700",children:[e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx(re,{})}),e.jsx("div",{className:"p-6 md:p-10 mb-10",children:e.jsxs("div",{className:"premium-card p-12 transition-all hover:shadow-2xl group/card border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-12 border-b border-gray-50 dark:border-white/5 pb-8",children:[e.jsx("div",{className:"p-4 rounded-3xl bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 group-hover/card:scale-110 transition-transform duration-500",children:e.jsx(G,{className:"w-10 h-10"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-black text-gray-900 dark:text-white tracking-tight leading-none",children:y.SETTINGS.ADBLOCK_DETECTION}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-base font-medium mt-2",children:y.SETTINGS.ADBLOCK_DESC})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-10 bg-white dark:bg-dark-800/40 rounded-[2.5rem] border border-gray-100 dark:border-white/5 shadow-sm hover:shadow-md transition-all duration-500",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-xl font-bold text-gray-900 dark:text-white",children:y.SETTINGS.ADBLOCK_ENABLED}),e.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-[10px] uppercase tracking-tighter font-black transition-all duration-500 ${l.adblock_enabled?"bg-green-500/10 text-green-600 dark:text-green-400":"bg-gray-100 dark:bg-dark-700 text-gray-500"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${l.adblock_enabled?"bg-green-500 animate-pulse":"bg-gray-400"}`}),l.adblock_enabled?"مفعل وقيد التشغيل":"معطل حالياً"]})]}),e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 max-w-xl leading-relaxed",children:"تفعيل خاصية الكشف الإلزامي تمنع المستخدمين من الوصول للمحتوى إلا بعد تعطيل مانع الإعلانات، مما يضمن استمرارية دعم المنصة وزيادة عوائد الإعلانات."})]}),e.jsx("div",{className:"flex items-center shrink-0",children:e.jsxs("button",{type:"button",disabled:c,onClick:async()=>{const s=!l.adblock_enabled;p({...l,adblock_enabled:s}),u(!0);try{await g.toggleAdBlock(s),await i({}),b("تم التحديث تلقائياً بنجاح")}catch{p({...l,adblock_enabled:!s}),h("فشل التحديث التلقائي")}finally{u(!1)}},className:`flex items-center gap-3 px-8 py-4 rounded-2xl font-black text-sm transition-all duration-500 shadow-xl group hover:scale-[1.02] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed ${l.adblock_enabled?"bg-orange-500 text-white hover:bg-orange-600 shadow-orange-500/30":"bg-white dark:bg-dark-700 text-gray-900 dark:text-white border border-gray-200 dark:border-white/10 hover:bg-gray-50 dark:hover:bg-dark-600 shadow-gray-200/20"}`,children:[c?e.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.jsx(Y,{className:`w-5 h-5 transition-transform duration-500 group-hover:rotate-12 ${l.adblock_enabled?"text-white":"text-primary"}`}),l.adblock_enabled?e.jsx("span",{children:"إيقاف التشغيل الفوري"}):e.jsx("span",{children:"تفعيل الكاشف (حفظ تلقائي)"})]})})]})]})})]})})}export{Ae as default};
